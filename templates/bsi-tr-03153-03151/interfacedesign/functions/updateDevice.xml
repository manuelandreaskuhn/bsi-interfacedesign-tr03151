<?xml version='1.0' encoding='utf-8'?>
<function xmlns="http://bsi.bund.de/TR03151" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="updateDevice" xsi:schemaLocation="http://bsi.bund.de/TR03151 ../../schema/functions.xsd">
  <name>updateDevice</name>
  <category>Gerätewartung</category>
  <description>
    <text xml:lang="en">Triggers the execution of a self test.</text>
    <text xml:lang="de">Löst die Ausführung eines Selbsttests aus.</text>
  </description>
  <detailedSteps>
    <step>
      <number>1</number>
      <standardStep number="1">
        <shortCommand xml:lang="de">Authentifizierung Nutzer</shortCommand>
        <shortCommand xml:lang="en">User Authentication</shortCommand>
      </standardStep>
      <description>
        <text xml:lang="en">If the referencing guideline limits the access to the functionality solely to authenticated users , the function SHALL check if the user that has invoked the function has the status authenticated. If the status is not authenticated, the function SHALL raise the exception ErrorUserNotAuthenticated and exit the function.</text>
        <text xml:lang="de">Prüft, ob Nutzer authentifiziert. Falls nicht: Exception ErrorUserNotAuthenticated, Ende.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">IF user NOT authenticated THEN
  THROW ErrorUserNotAuthenticated
  EXIT function
END</text>
        <text xml:lang="de">WENN Benutzer NICHT authentifiziert DANN
  WERFE ErrorUserNotAuthenticated
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorUserNotAuthenticated</exception>
        <trigger>
          <text xml:lang="en">The user is not authenticated</text>
          <text xml:lang="de">Der Benutzer ist nicht authentifiziert</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>2</number>
      <standardStep number="2">
        <shortCommand xml:lang="de">Autorisierung Nutzer</shortCommand>
        <shortCommand xml:lang="en">User Authorization</shortCommand>
      </standardStep>
      <description>
        <text xml:lang="en">If the referencing guideline limits the access to the functionality to certain roles, the function SHALL check in the corresponding role if the (unauthenticated) user is authorized to execute the function. If the user is not authorized, the function SHALL raise the exception ErrorUserNotAuthorized and exit the function.</text>
        <text xml:lang="de">Prüft, ob Nutzer berechtigt. Falls nicht: Exception ErrorUserNotAuthorized, Ende.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">IF user NOT authorized THEN
  THROW ErrorUserNotAuthorized
  EXIT function
END</text>
        <text xml:lang="de">WENN Benutzer NICHT autorisiert DANN
  WERFE ErrorUserNotAuthorized
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorUserNotAuthorized</exception>
        <trigger>
          <text xml:lang="en">The user is not authorized</text>
          <text xml:lang="de">Der Benutzer ist nicht berechtigt</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>3</number>
      <description>
        <text xml:lang="en">The function SHALL check if there are open transactions that are currently managed by the Secure Element. If at least one transaction was started but is not finished and not classified abandoned, the function SHOULD raise the exception ErrorOpenTransactionFound and exit the function.</text>
        <text xml:lang="de">Prüfe, ob offene Transaktionen vom Secure Element verwaltet werden. Falls mindestens eine Transaktion gestartet, nicht beendet und nicht als verwaist klassifiziert ist: Werfe ErrorOpenTransactionFound und beende Funktion.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">IF open transactions exist THEN
  THROW ErrorOpenTransactionFound
  EXIT function
END</text>
        <text xml:lang="de">WENN offene Transaktionen vorhanden DANN
  WERFE ErrorOpenTransactionFound
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorOpenTransactionFound</exception>
        <trigger>
          <text xml:lang="en">Open transactions exist</text>
          <text xml:lang="de">Offene Transaktionen vorhanden</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>4</number>
      <standardStep number="3">
        <shortCommand xml:lang="de">Zeit-Prüfung</shortCommand>
        <shortCommand xml:lang="en">Time Verification</shortCommand>
      </standardStep>
      <description>
        <text xml:lang="en">If the current time in the SE is not set, the function SHALL raise the exception ErrorTimeNotSet and exit the function.</text>
        <text xml:lang="de">Falls die aktuelle Zeit im SE nicht gesetzt ist: Werfe ErrorTimeNotSet und beende Funktion.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">IF current time in SE NOT set THEN
  THROW ErrorTimeNotSet
  EXIT function
END</text>
        <text xml:lang="de">WENN Aktuelle Zeit im SE NICHT gesetzt DANN
  WERFE ErrorTimeNotSet
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorTimeNotSet</exception>
        <trigger>
          <text xml:lang="en">The current time in SE is not set</text>
          <text xml:lang="de">Die aktuelle Zeit im SE ist nicht gesetzt</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>5</number>
      <standardStep number="5">
        <shortCommand xml:lang="de">SE-Funktionalität Log-Erstellung</shortCommand>
        <shortCommand xml:lang="en">SE Log Message Creation</shortCommand>
      </standardStep>
      <description>
        <text xml:lang="en">The function SHALL invoke the functionality of the Secure Element to create the log message parts to log the start of the update.</text>
        <text xml:lang="de">Rufe Secure-Element-Funktionalität auf, um Log-Nachricht-Teile für Update-Start zu erstellen. Bei Fehler: Werfe ErrorSigningEventDataFailed und beende Funktion.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">TRY
  INVOKE SE functionality to create log message
  CREATE log message parts for update start
CATCH error
  THROW ErrorSigningEventDataFailed
  EXIT function
END</text>
        <text xml:lang="de">VERSUCHE
  RUFE_AUF Secure-Element-Funktionalität
  ERSTELLE Log-Nachricht-Teile für Update-Start
BEI_FEHLER
  WERFE ErrorSigningEventDataFailed
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorSigningEventDataFailed</exception>
        <trigger>
          <text xml:lang="en">SE functionality fails</text>
          <text xml:lang="de">Secure-Element-Funktionalität fehlgeschlagen</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>6</number>
      <standardStep number="6">
        <shortCommand xml:lang="de">Log-Nachricht-Teile abrufen</shortCommand>
        <shortCommand xml:lang="en">Retrieve Log Message Parts</shortCommand>
      </standardStep>
      <description>
        <text xml:lang="en">The function SHALL retrieve the parts of the log message determined by the Secure Element. If the retrieval of the log message parts fails, the function SHALL raise the exception ErrorRetrieveLogMessageFailed and exit the function.</text>
        <text xml:lang="de">Hole die Log-Nachricht-Teile vom Secure Element. Falls der Abruf fehlschlägt: Werfe ErrorRetrieveLogMessageFailed und beende Funktion.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">TRY
  RETRIEVE log message parts from SE
CATCH error
  THROW ErrorRetrieveLogMessageFailed
  EXIT function
END</text>
        <text xml:lang="de">VERSUCHE
  HOLE Log-Nachricht-Teile vom Secure Element
BEI_FEHLER
  WERFE ErrorRetrieveLogMessageFailed
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorRetrieveLogMessageFailed</exception>
        <trigger>
          <text xml:lang="en">Retrieval of log message parts fails</text>
          <text xml:lang="de">Der Abruf der Log-Nachricht-Teile schlägt fehl</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>7</number>
      <standardStep number="7">
        <shortCommand xml:lang="de">Log-Nachricht-Teile speichern</shortCommand>
        <shortCommand xml:lang="en">Store Log Message Parts</shortCommand>
      </standardStep>
      <description>
        <text xml:lang="en">The function SHALL store the data of the retrieved log message parts. If the data has not been stored successfully, the function SHALL raise the exception ErrorStoringLogMessageFailed and exit the function.</text>
        <text xml:lang="de">Speichere die Log-Nachricht-Teile. Falls Speicherung fehlschlägt: Werfe ErrorStoringLogMessageFailed und beende Funktion.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">TRY
  STORE log message parts
CATCH error
  THROW ErrorStoringLogMessageFailed
  EXIT function
END</text>
        <text xml:lang="de">VERSUCHE
  SPEICHERE Log-Nachricht-Teile
BEI_FEHLER
  WERFE ErrorStoringLogMessageFailed
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorStoringLogMessageFailed</exception>
        <trigger>
          <text xml:lang="en">Data not stored successfully</text>
          <text xml:lang="de">Die Daten wurden nicht erfolgreich gespeichert</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>8</number>
      <description>
        <text xml:lang="en">The function SHALL update the device. The following steps MUST be performed, but MAY be performed after the initial function call to updateDevice has been terminated – for example because of a reboot of the device which is part of the update process. The steps are in any case still logically considered part of the updateDevice function.</text>
        <text xml:lang="de">Führe das Geräte-Update durch. Folgende Schritte können nach dem Funktionsaufruf ausgeführt werden (z.B. nach Geräte-Neustart). Sie sind logisch Teil dieser Funktion.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">TRY
  PERFORM device update
CATCH error
  LOG failed update attempt
  THROW ErrorUpdateDeviceFailed
  EXIT function
END</text>
        <text xml:lang="de">VERSUCHE
  UPDATE_DEVICE
BEI_FEHLER
  RUFE_AUF Protokollierung fehlgeschlagener Update-Versuch
  WERFE ErrorUpdateDeviceFailed
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorUpdateDeviceFailed</exception>
        <trigger>
          <text xml:lang="en">Device update fails</text>
          <text xml:lang="de">Geräte-Update fehlgeschlagen</text>
        </trigger>
        <action>
          <text xml:lang="en">Log error, exit function</text>
          <text xml:lang="de">Protokolliere Fehler, Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>9</number>
      <description>
        <text xml:lang="en">If the update process fails, the function SHALL perform the steps described in 3.3.5.6.1 to log the failed update attempt. This includes the termination of the function updateDevice.</text>
        <text xml:lang="de">Falls Update-Prozess fehlschlägt: Führe Protokollierungsschritte für fehlgeschlagenen Update-Versuch durch und beende Funktion.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">TRY
  LOG failed update attempt
CATCH error
  THROW ErrorSigningEventDataFailed or ErrorStoringLogMessageFailed
  EXIT function
END</text>
        <text xml:lang="de">VERSUCHE
  LOG fehlgeschlagener Update-Versuch
BEI_FEHLER
  WERFE ErrorSigningEventDataFailed oder ErrorStoringLogMessageFailed
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorSigningEventDataFailed</exception>
        <trigger>
          <text xml:lang="en">Logging of update failure fails</text>
          <text xml:lang="de">Protokollierung des Update-Fehlers fehlgeschlagen</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>10</number>
      <standardStep number="5">
        <shortCommand xml:lang="de">SE-Funktionalität Log-Erstellung</shortCommand>
        <shortCommand xml:lang="en">SE Log Message Creation</shortCommand>
      </standardStep>
      <description>
        <text xml:lang="en">The function SHALL invoke the functionality of the Secure Element to create the log message parts to log the completion of the update.</text>
        <text xml:lang="de">Rufe Secure-Element-Funktionalität auf, um Log-Nachricht-Teile für Update-Abschluss zu erstellen. Bei Fehler: Werfe ErrorSigningEventDataFailed und beende Funktion.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">TRY
  INVOKE SE functionality to create log message
  CREATE log message parts for update completion
CATCH error
  THROW ErrorSigningEventDataFailed
  EXIT function
END</text>
        <text xml:lang="de">VERSUCHE
  RUFE_AUF Secure-Element-Funktionalität
  ERSTELLE Log-Nachricht-Teile für Update-Abschluss
BEI_FEHLER
  WERFE ErrorSigningEventDataFailed
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorSigningEventDataFailed</exception>
        <trigger>
          <text xml:lang="en">SE functionality fails</text>
          <text xml:lang="de">Secure-Element-Funktionalität fehlgeschlagen</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>11</number>
      <standardStep number="6">
        <shortCommand xml:lang="de">Log-Nachricht-Teile abrufen</shortCommand>
        <shortCommand xml:lang="en">Retrieve Log Message Parts</shortCommand>
      </standardStep>
      <description>
        <text xml:lang="en">The function SHALL retrieve the parts of the log message determined by the Secure Element. If the retrieval of the log message parts fails, the function SHOULD raise the exception ErrorRetrieveLogMessageFailed and exit the function.</text>
        <text xml:lang="de">Hole die Log-Nachricht-Teile vom Secure Element. Falls Abruf fehlschlägt: Werfe ErrorRetrieveLogMessageFailed und beende Funktion.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">TRY
  RETRIEVE log message parts from SE
CATCH error
  THROW ErrorRetrieveLogMessageFailed
  EXIT function
END</text>
        <text xml:lang="de">VERSUCHE
  HOLE Log-Nachricht-Teile vom Secure Element
BEI_FEHLER
  WERFE ErrorRetrieveLogMessageFailed
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorRetrieveLogMessageFailed</exception>
        <trigger>
          <text xml:lang="en">Retrieval of log message parts fails</text>
          <text xml:lang="de">Abruf der Log-Nachricht-Teile fehlgeschlagen</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>12</number>
      <standardStep number="7">
        <shortCommand xml:lang="de">Log-Nachricht-Teile speichern</shortCommand>
        <shortCommand xml:lang="en">Store Log Message Parts</shortCommand>
      </standardStep>
      <description>
        <text xml:lang="en">The function SHALL store the data of the retrieved log message parts. If the data has not been stored successfully, the function SHOULD raise the exception ErrorStoringLogMessageFailed and exit the function.</text>
        <text xml:lang="de">Speichere die Log-Nachricht-Teile. Falls Speicherung fehlschlägt: Werfe ErrorStoringLogMessageFailed und beende Funktion.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">TRY
  STORE log message parts
CATCH error
  THROW ErrorStoringLogMessageFailed
  EXIT function
END</text>
        <text xml:lang="de">VERSUCHE
  SPEICHERE Log-Nachricht-Teile
BEI_FEHLER
  WERFE ErrorStoringLogMessageFailed
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorStoringLogMessageFailed</exception>
        <trigger>
          <text xml:lang="en">Storage fails</text>
          <text xml:lang="de">Speicherung fehlgeschlagen</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>13</number>
      <standardStep number="9">
        <shortCommand xml:lang="de">Erfolgreiche Rückgabe</shortCommand>
        <shortCommand xml:lang="en">Successful Return</shortCommand>
      </standardStep>
      <description>
        <text xml:lang="en">The function SHOULD return without raising an exception to indicate that the execution of the function updateDevice has been successful.</text>
        <text xml:lang="de">Gebe ohne Exception zurück, um erfolgreiche Ausführung anzuzeigen.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">RETURN without exception
END SUCCESSFULLY</text>
        <text xml:lang="de">RETURN ohne Exception
BEENDE_ERFOLGREICH</text>
      </pseudocode>
      <successCase>
        <condition>
          <text xml:lang="en">Update successful</text>
          <text xml:lang="de">Update war erfolgreich</text>
        </condition>
        <action>
          <text xml:lang="en">Function returns without exception</text>
          <text xml:lang="de">Funktion kehrt ohne Exception zurück</text>
        </action>
      </successCase>
    </step>
  </detailedSteps>
  <parameters>
    <parameter>
      <name>update</name>
      <type>InputStream</type>
      <description>
        <text xml:lang="en">the update data for the device.</text>
        <text xml:lang="de">die Update-Daten für das Gerät.</text>
      </description>
      <direction>INPUT</direction>
      <required>true</required>
    </parameter>
  </parameters>
  <returnValue>
    <type>void</type>
    <description>
      <text xml:lang="en">This function does not return a value.</text>
      <text xml:lang="de">Diese Funktion gibt keinen Wert zurück.</text>
    </description>
  </returnValue>
  <exceptions>
    <exception>ErrorCertificateExpired</exception>
    <exception>ErrorDeviceNotInitialized</exception>
    <exception>ErrorFunctionFailed</exception>
    <exception>ErrorFunctionNotSupported</exception>
    <exception>ErrorOpenTransactionFound</exception>
    <exception>ErrorParameterSyntax</exception>
    <exception>ErrorParameterTooLong</exception>
    <exception>ErrorRetrieveLogMessageFailed</exception>
    <exception>ErrorSecureElementDisabled</exception>
    <exception>ErrorSecureElementPartsDisconnected</exception>
    <exception>ErrorSignatureCounterExhausted</exception>
    <exception>ErrorSignatureCounterOverflow</exception>
    <exception>ErrorSigningEventDataFailed</exception>
    <exception>ErrorStorageMediumDisconnected</exception>
    <exception>ErrorStorageMemoryFull</exception>
    <exception>ErrorStoringLogMessageFailed</exception>
    <exception>ErrorTimeNotSet</exception>
    <exception>ErrorUpdateDeviceFailed</exception>
    <exception>ErrorUserNotAuthenticated</exception>
    <exception>ErrorUserNotAuthorized</exception>
  </exceptions>
  <systemLog>
    <logType>system</logType>
    <requirement>MUST</requirement>
    <asn1Structure>
      <logMessage>LogMessage ::= SEQUENCE {
  version                INTEGER (3),
  certifiedDataType      OBJECT IDENTIFIER (id-SE-API-system-log),
  certifiedData          SystemLogMessage,  -- embedded system log
  serialNumber           OCTET STRING (SIZE (32)),
  signatureAlgorithm     AlgorithmIdentifier,
  seAuditData            OCTET STRING OPTIONAL,
  signatureCounter       INTEGER,
  signatureCreationTime  Time,
  signatureValue         OCTET STRING
}</logMessage>
      <systemLogMessage>SystemLogMessage ::= SEQUENCE {
  version                    INTEGER (3),
  certifiedDataType          OBJECT IDENTIFIER (id-SE-API-system-log),
  eventType                  [0] IMPLICIT PrintableString ("updateDevice"),
  eventOrigin                [1] IMPLICIT PrintableString OPTIONAL,
  eventTriggeredByUser       [2] IMPLICIT UserId OPTIONAL,
  eventData                  [3] IMPLICIT UpdateDeviceEventData,
  additionalInternalData     [4] IMPLICIT OCTET STRING OPTIONAL,
  serialNumber               OCTET STRING (SIZE (32)),
  signatureAlgorithm         AlgorithmIdentifier,
  signatureCounter           INTEGER,
  signatureCreationTime      Time,
  signatureValue             OCTET STRING
}

UpdateDeviceEventData ::= SEQUENCE {
    deviceInformationBeforeUpdate  DeviceInformationSet
}</systemLogMessage>
    </asn1Structure>
    <structure>
      <field>
        <name>version</name>
        <type>INTEGER (3)</type>
        <required>true</required>
        <defaultValue>3</defaultValue>
        <description>
          <text xml:lang="en">Version of the log message format. SHALL be set to '3'.</text>
          <text xml:lang="de">Version des Log-Nachricht-Formats. MUSS auf '3' gesetzt sein.</text>
        </description>
        <origin>Provided by the device</origin>
      </field>
      <field>
        <name>certifiedDataType</name>
        <type>OBJECT IDENTIFIER</type>
        <required>true</required>
        <defaultValue>id-SE-API-system-log</defaultValue>
        <description>
          <text xml:lang="en">MUST be set to the OID id-SE-API-system-log.</text>
          <text xml:lang="de">MUSS auf die OID id-SE-API-system-log gesetzt sein.</text>
        </description>
        <origin>Provided by the device</origin>
      </field>
      <field>
        <name>eventType</name>
        <type>PrintableString</type>
        <tag>[0] IMPLICIT</tag>
        <required>true</required>
        <defaultValue>updateDevice</defaultValue>
        <description>
          <text xml:lang="en">MUST be set to 'updateDevice'.</text>
          <text xml:lang="de">MUSS auf 'updateDevice' gesetzt sein.</text>
        </description>
        <origin>Provided by the device</origin>
      </field>
      <field>
        <name>eventOrigin</name>
        <type>PrintableString</type>
        <tag>[1] IMPLICIT</tag>
        <required>false</required>
        <description>
          <text xml:lang="en">Component that triggered the event (e.g., component name).</text>
          <text xml:lang="de">Komponente, die das Ereignis ausgelöst hat (z.B. Komponentenname).</text>
        </description>
        <origin>Provided by the device</origin>
      </field>
      <field>
        <name>eventTriggeredByUser</name>
        <type>UserId</type>
        <tag>[2] IMPLICIT</tag>
        <required>false</required>
        <description>
          <text xml:lang="en">User ID of the user that triggered the event.</text>
          <text xml:lang="de">Benutzer-ID des Benutzers, der das Ereignis ausgelöst hat.</text>
        </description>
        <origin>Provided by the device</origin>
      </field>
      <field>
        <name>eventData</name>
        <type>UpdateDeviceEventData</type>
        <tag>[3] IMPLICIT</tag>
        <required>true</required>
        <description>
          <text xml:lang="en">Function-specific event data.</text>
          <text xml:lang="de">Funktionsspezifische Ereignisdaten.</text>
        </description>
        <origin>Provided by the device</origin>
      </field>
      <field>
        <name>additionalInternalData</name>
        <type>OCTET STRING</type>
        <tag>[4] IMPLICIT</tag>
        <required>false</required>
        <description>
          <text xml:lang="en">MUST NOT be present. Reserved for future use.</text>
          <text xml:lang="de">DARF NICHT vorhanden sein. Für zukünftige Verwendung reserviert.</text>
        </description>
        <note>RFU</note>
        <origin>-</origin>
      </field>
      <field>
        <name>serialNumber</name>
        <type>OCTET STRING (SIZE (32))</type>
        <required>true</required>
        <description>
          <text xml:lang="en">Serial number of the Secure Element consisting of the hash value of the public key of the certificate used to verify system logs.</text>
          <text xml:lang="de">Seriennummer des Secure Element bestehend aus dem Hash-Wert des öffentlichen Schlüssels des Zertifikats zur Überprüfung von Systemprotokollen.</text>
        </description>
        <origin>Provided by the device</origin>
      </field>
      <field>
        <name>signatureAlgorithm</name>
        <type>AlgorithmIdentifier</type>
        <required>true</required>
        <description>
          <text xml:lang="en">Information about the signature creation.</text>
          <text xml:lang="de">Informationen über die Signaturerstellung.</text>
        </description>
        <origin>Provided by the device</origin>
      </field>
      <field>
        <name>signatureCounter</name>
        <type>INTEGER</type>
        <required>true</required>
        <description>
          <text xml:lang="en">Current count of signatures created with the log message signing key protected by the Secure Element.</text>
          <text xml:lang="de">Aktueller Zähler der mit dem durch das Secure Element geschützten Log-Nachricht-Signaturschlüssel erstellten Signaturen.</text>
        </description>
        <origin>Provided by the Secure Element</origin>
      </field>
      <field>
        <name>signatureCreationTime</name>
        <type>Time</type>
        <required>true</required>
        <description>
          <text xml:lang="en">Point in time of the Secure Element when the log message was signed.</text>
          <text xml:lang="de">Zeitpunkt des Secure Element, als die Log-Nachricht signiert wurde.</text>
        </description>
        <origin>Provided by the Secure Element</origin>
      </field>
      <field>
        <name>signatureValue</name>
        <type>OCTET STRING</type>
        <required>true</required>
        <description>
          <text xml:lang="en">Result of the signature computation encoded as octet string.</text>
          <text xml:lang="de">Ergebnis der Signaturberechnung codiert als Oktettkette.</text>
        </description>
        <origin>Provided by the Secure Element</origin>
      </field>
    </structure>
  </systemLog>
</function>
