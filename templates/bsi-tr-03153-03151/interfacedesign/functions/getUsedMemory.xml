<?xml version='1.0' encoding='utf-8'?>
<function xmlns="http://bsi.bund.de/TR03151" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="getUsedMemory" xsi:schemaLocation="http://bsi.bund.de/TR03151 ../../schema/functions.xsd">
  <name>getUsedMemory</name>
  <category>Speicherverwaltung</category>
  <description>
    <text xml:lang="en">The function getUsedMemory can be used to get the used storage space.</text>
    <text xml:lang="de">Die Funktion getUsedMemory kann verwendet werden, um den genutzten Speicherplatz zu ermitteln.</text>
  </description>
  <detailedSteps>
    <step>
      <number>1</number>
      <standardStep number="1">
        <shortCommand xml:lang="de">Authentifizierung Nutzer</shortCommand>
        <shortCommand xml:lang="en">User Authentication</shortCommand>
      </standardStep>
      <description>
        <text xml:lang="en">If the referencing guideline limits the access to the functionality solely to authenticated users, the function SHALL check if the user that has invoked the function has the status authenticated. If the status is not authenticated, the function SHALL raise the exception ErrorUserNotAuthenticated and exit the function.</text>
        <text xml:lang="de">Prüft, ob Nutzer authentifiziert. Falls nicht: Exception ErrorUserNotAuthenticated, Ende.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">IF user NOT authenticated THEN
  THROW ErrorUserNotAuthenticated
  EXIT function
END</text>
        <text xml:lang="de">WENN Benutzer NICHT authentifiziert DANN
  WERFE ErrorUserNotAuthenticated
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorUserNotAuthenticated</exception>
        <trigger>
          <text xml:lang="en">The user is not authenticated</text>
          <text xml:lang="de">Der Benutzer ist nicht authentifiziert</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>2</number>
      <standardStep number="2">
        <shortCommand xml:lang="de">Autorisierung Nutzer</shortCommand>
        <shortCommand xml:lang="en">User Authorization</shortCommand>
      </standardStep>
      <description>
        <text xml:lang="en">If the referencing guideline limits the access to the functionality to certain roles, the function SHALL check in the corresponding role if the (unauthenticated) user is authorized to execute the function. If the user is not authorized, the function SHALL raise the exception ErrorUserNotAuthorized and exit the function.</text>
        <text xml:lang="de">Prüft, ob Nutzer berechtigt. Falls nicht: Exception ErrorUserNotAuthorized, Ende.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">IF user NOT authorized THEN
  THROW ErrorUserNotAuthorized
  EXIT function
END</text>
        <text xml:lang="de">WENN Benutzer NICHT autorisiert DANN
  WERFE ErrorUserNotAuthorized
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorUserNotAuthorized</exception>
        <trigger>
          <text xml:lang="en">The user is not authorized</text>
          <text xml:lang="de">Der Benutzer ist nicht berechtigt</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>3</number>
      <description>
        <text xml:lang="en">The function SHALL determine the amount of memory currently in use. If the determination of the amount of memory currently in use fails, the function SHALL raise the exception ErrorGetUsedMemoryFailed and exit the function.</text>
        <text xml:lang="de">Ermittelt den derzeit genutzten Speicherumfang. Bei Fehler: Exception ErrorGetUsedMemoryFailed, Ende.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">TRY
  DETERMINE used memory amount
CATCH error
  THROW ErrorGetUsedMemoryFailed
  EXIT function
END</text>
        <text xml:lang="de">VERSUCHE
  ERMITTLE Menge des genutzten Speichers
BEI_FEHLER
  WERFE ErrorGetUsedMemoryFailed
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorGetUsedMemoryFailed</exception>
        <trigger>
          <text xml:lang="en">The determination of used memory fails</text>
          <text xml:lang="de">Die Ermittlung des genutzten Speichers schlägt fehl</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>4</number>
      <description>
        <text xml:lang="en">If the determination of the amount of memory currently in use has been successful, the function SHALL return the amount of memory currently in use by usage of the output parameter usedMemory. Additionally, the function SHALL return without raising an exception to indicate that the execution of the function getUsedMemory has been successful.</text>
        <text xml:lang="de">Bei Erfolg der Ermittlung: Gibt genutzten Speicherumfang via Parameter usedMemory zurück. Keine Exception.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">RETURN usedMemory without exception</text>
        <text xml:lang="de">GEBE genutzten Speicher zurück (usedMemory Parameter)
RETURN ohne Exception</text>
      </pseudocode>
      <successCase>
        <condition>
          <text xml:lang="en">The determination of used memory has been successful</text>
          <text xml:lang="de">Ermittlung des genutzten Speichers erfolgreich</text>
        </condition>
        <action>
          <text xml:lang="en">Return the used memory amount without raising an exception</text>
          <text xml:lang="de">Gibt genutzten Speicher via Parameter zurück</text>
        </action>
      </successCase>
    </step>
  </detailedSteps>
  <parameters />
  <returnValue>
    <type>long</type>
    <description>
      <text xml:lang="en">the used memory of the storage medium in bytes.</text>
      <text xml:lang="de">der genutzte Speicher des Speichermediums in Bytes.</text>
    </description>
  </returnValue>
  <exceptions>
    <exception>ErrorDeviceNotInitialized</exception>
    <exception>ErrorFunctionFailed</exception>
    <exception>ErrorFunctionNotSupported</exception>
    <exception>ErrorGetUsedMemoryFailed</exception>
    <exception>ErrorParameterSyntax</exception>
    <exception>ErrorStorageMediumDisconnected</exception>
    <exception>ErrorUserNotAuthenticated</exception>
    <exception>ErrorUserNotAuthorized</exception>
  </exceptions>
</function>
