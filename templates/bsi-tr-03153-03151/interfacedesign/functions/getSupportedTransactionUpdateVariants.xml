<?xml version='1.0' encoding='utf-8'?>
<function xmlns="http://bsi.bund.de/TR03151" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="getSupportedTransactionUpdateVariants" xsi:schemaLocation="http://bsi.bund.de/TR03151 ../../schema/functions.xsd">
  <name>getSupportedTransactionUpdateVariants</name>
  <category>Client- und Transaktionsverwaltung</category>
  <description>
    <text xml:lang="en">The function getSupportedTransactionUpdateVariants can be used to obtain information how updates of transactions are performed.</text>
    <text xml:lang="de">Die Funktion getSupportedTransactionUpdateVariants kann verwendet werden, um Informationen darüber zu erhalten, wie Aktualisierungen von Transaktionen durchgeführt werden.</text>
  </description>
  <detailedSteps>
    <step>
      <number>1</number>
      <standardStep number="1">
        <shortCommand xml:lang="de">Authentifizierung Nutzer</shortCommand>
        <shortCommand xml:lang="en">User Authentication</shortCommand>
      </standardStep>
      <description>
        <text xml:lang="en">If the referencing guideline limits the access to the functionality solely to authenticated users, the function SHALL check if the user that has invoked the function has the status authenticated. If the status is not authenticated, the function SHALL raise the exception ErrorUserNotAuthenticated and exit the function.</text>
        <text xml:lang="de">Prüft, ob Nutzer authentifiziert. Falls nicht: Exception ErrorUserNotAuthenticated, Ende.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">IF user NOT authenticated THEN
  THROW ErrorUserNotAuthenticated
  EXIT function
END</text>
        <text xml:lang="de">WENN Benutzer NICHT authentifiziert DANN
  WERFE ErrorUserNotAuthenticated
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorUserNotAuthenticated</exception>
        <trigger>
          <text xml:lang="en">The user is not authenticated</text>
          <text xml:lang="de">Der Benutzer ist nicht authentifiziert</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>2</number>
      <standardStep number="2">
        <shortCommand xml:lang="de">Autorisierung Nutzer</shortCommand>
        <shortCommand xml:lang="en">User Authorization</shortCommand>
      </standardStep>
      <description>
        <text xml:lang="en">If the referencing guideline limits the access to the functionality to certain roles, the function SHALL check in the corresponding role if the (unauthenticated) user is authorized to execute the function. If the user is not authorized, the function SHALL raise the exception ErrorUserNotAuthorized and exit the function.</text>
        <text xml:lang="de">Prüft, ob Nutzer berechtigt. Falls nicht: Exception ErrorUserNotAuthorized, Ende.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">IF user NOT authorized THEN
  THROW ErrorUserNotAuthorized
  EXIT function
END</text>
        <text xml:lang="de">WENN Benutzer NICHT autorisiert DANN
  WERFE ErrorUserNotAuthorized
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorUserNotAuthorized</exception>
        <trigger>
          <text xml:lang="en">The user is not authorized</text>
          <text xml:lang="de">Der Benutzer ist nicht berechtigt</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>3</number>
      <description>
        <text xml:lang="en">The function getSupportedTransactionUpdateVariants SHALL identify the supported variants to update transactions.</text>
        <text xml:lang="de">Ermittelt die unterstützten Varianten zum Aktualisieren von Transaktionen.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">TRY
  RETRIEVE supported update variants from SE
CATCH error
  THROW ErrorGetSupportedUpdateVariantsFailed
END</text>
        <text xml:lang="de">VERSUCHE
  HOLE unterstützte Update-Varianten vom SE
BEI_FEHLER
  WERFE ErrorGetSupportedUpdateVariantsFailed
ENDE</text>
      </pseudocode>
    </step>
    <step>
      <number>4</number>
      <description>
        <text xml:lang="en">If the identification of the supported update variant(s) fails, the function SHALL raise the exception ErrorGetSupportedUpdateVariantsFailed and exit the function.</text>
        <text xml:lang="de">Falls die Identifikation schlägt fehl: Werfe ErrorGetSupportedUpdateVariantsFailed und beende Funktion.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">IF operation failed THEN
  THROW ErrorGetSupportedUpdateVariantsFailed
  EXIT function
END</text>
        <text xml:lang="de">WENN Operation fehlgeschlagen DANN
  WERFE ErrorGetSupportedUpdateVariantsFailed
  BEENDE_FUNKTION
ENDE</text>
      </pseudocode>
      <errorCase>
        <exception>ErrorGetSupportedUpdateVariantsFailed</exception>
        <trigger>
          <text xml:lang="en">The identification of the update variants fails</text>
          <text xml:lang="de">Die Identifikation der Update-Varianten schlägt fehl</text>
        </trigger>
        <action>
          <text xml:lang="en">Exit function</text>
          <text xml:lang="de">Funktion beenden</text>
        </action>
      </errorCase>
    </step>
    <step>
      <number>5</number>
      <description>
        <text xml:lang="en">If the identification of the supported update variant(s) has been successful, the function SHALL return the information regarding the supported update variants over the output parameter supportedUpdateVariants. Additionally, the function SHALL return without raising an exception to indicate that the execution of the function has been successful.</text>
        <text xml:lang="de">Bei Erfolg der Identifikation: Gibt unterstützte Update-Varianten via Parameter supportedUpdateVariants zurück. Keine Exception.</text>
      </description>
      <pseudocode>
        <text xml:lang="en">RETURN supportedUpdateVariants without exception</text>
        <text xml:lang="de">GEBE Update-Varianten zurück (supportedUpdateVariants Parameter)
RETURN ohne Exception</text>
      </pseudocode>
      <successCase>
        <condition>
          <text xml:lang="en">Identification of the update variants has been successful</text>
          <text xml:lang="de">Identifikation der Update-Varianten erfolgreich</text>
        </condition>
        <action>
          <text xml:lang="en">Return the supported update variants without raising an exception</text>
          <text xml:lang="de">Gibt Update-Varianten via Parameter zurück</text>
        </action>
      </successCase>
    </step>
  </detailedSteps>
  <parameters />
  <returnValue>
    <type>UpdateVariants</type>
    <description>
      <text xml:lang="en">the transaction update variant(s) that the device supports (alwaysSigned, aggregating, or alwaysSignedAndAggregating).</text>
      <text xml:lang="de">die Transaktionsupdate-Variante(n), die das Gerät unterstützt (alwaysSigned, aggregating oder alwaysSignedAndAggregating).</text>
    </description>
  </returnValue>
  <exceptions>
    <exception>ErrorDeviceNotInitialized</exception>
    <exception>ErrorFunctionFailed</exception>
    <exception>ErrorFunctionNotSupported</exception>
    <exception>ErrorGetSupportedUpdateVariantsFailed</exception>
    <exception>ErrorParameterSyntax</exception>
    <exception>ErrorSecureElementDisabled</exception>
    <exception>ErrorUserNotAuthenticated</exception>
    <exception>ErrorUserNotAuthorized</exception>
  </exceptions>
</function>
