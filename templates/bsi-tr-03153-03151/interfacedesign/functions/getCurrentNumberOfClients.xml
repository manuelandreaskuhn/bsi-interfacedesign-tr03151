<?xml version='1.0' encoding='utf-8'?>
<function xmlns="http://bsi.bund.de/TR03151" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="getCurrentNumberOfClients" xsi:schemaLocation="http://bsi.bund.de/TR03151 ../../schema/functions.xsd">
  <name>getCurrentNumberOfClients</name>
  <category>Client- und Transaktionsverwaltung</category>
  <description>The function getCurrentNumberOfClients can be used to get the number of distinct clients that started or updated transactions that have not been finished yet ("are currently involved with open transactions").</description>
  <detailedSteps>
    <step>
      <number>1</number>
      <originalText>If the referencing guideline limits the access to the functionality solely to authenticated users, the function SHALL check if the user that has invoked the function has the status authenticated. If the status is not authenticated, the function SHALL raise the exception ErrorUserNotAuthenticated and exit the function.</originalText>
      <germanText>Prüft, ob Nutzer authentifiziert. Falls nicht: Exception ErrorUserNotAuthenticated, Ende.</germanText>
      <pseudocode>WENN Benutzer NICHT authentifiziert DANN
  WERFE ErrorUserNotAuthenticated
  BEENDE_FUNKTION
ENDE</pseudocode>
      <errorCase>
        <exception>ErrorUserNotAuthenticated</exception>
        <trigger>Der Benutzer ist nicht authentifiziert</trigger>
        <action>Funktion beenden</action>
      </errorCase>
    </step>
    <step>
      <number>2</number>
      <originalText>If the referencing guideline limits the access to the functionality to certain roles, the function SHALL check in the corresponding role if the (unauthenticated) user is authorized to execute the function. If the user is not authorized, the function SHALL raise the exception ErrorUserNotAuthorized and exit the function.</originalText>
      <germanText>Prüft, ob Nutzer berechtigt. Falls nicht: Exception ErrorUserNotAuthorized, Ende.</germanText>
      <pseudocode>WENN Benutzer NICHT autorisiert DANN
  WERFE ErrorUserNotAuthorized
  BEENDE_FUNKTION
ENDE</pseudocode>
      <errorCase>
        <exception>ErrorUserNotAuthorized</exception>
        <trigger>Der Benutzer ist nicht berechtigt</trigger>
        <action>Funktion beenden</action>
      </errorCase>
    </step>
    <step>
      <number>3</number>
      <originalText>If the device supports a practically unlimited number of clients simultaneously and at the same time does not track the current number of clients, the function SHALL raise the exception ErrorCurrentNumberOfClientsNotTracked and exit the function.</originalText>
      <germanText>Gerät unterstützt unbegrenzt viele Clients, aber zählt nicht: Exception ErrorCurrentNumberOfClientsNotTracked, Ende.</germanText>
      <pseudocode>WENN Gerät unbegrenzte Clients unterstützt UND zählt nicht ab DANN
  WERFE ErrorCurrentNumberOfClientsNotTracked
  BEENDE_FUNKTION
ENDE</pseudocode>
      <errorCase>
        <exception>ErrorCurrentNumberOfClientsNotTracked</exception>
        <trigger>Das Gerät unterstützt praktisch unbegrenzte Clients</trigger>
        <action>Funktion beenden</action>
      </errorCase>
    </step>
    <step>
      <number>4</number>
      <originalText>The function SHALL determine the number of current clients that started or updated transactions that have not been finished yet. If the determination of the current number of clients fails, the function SHALL raise the exception ErrorGetCurrentNumberOfClientsFailed and exit the function.</originalText>
      <germanText>Ermittelt aktuelle Clientanzahl. Bei Fehler: Exception ErrorGetCurrentNumberOfClientsFailed, Ende.</germanText>
      <pseudocode>VERSUCHE
  ERMITTLE Anzahl aktueller Clients mit offenen Transaktionen
BEI_FEHLER
  WERFE ErrorGetCurrentNumberOfClientsFailed
  BEENDE_FUNKTION
ENDE</pseudocode>
      <errorCase>
        <exception>ErrorGetCurrentNumberOfClientsFailed</exception>
        <trigger>Die Ermittlung der Clientanzahl schlägt fehl</trigger>
        <action>Funktion beenden</action>
      </errorCase>
    </step>
    <step>
      <number>5</number>
      <originalText>If the determination of the current number of clients has been successful, the function SHALL return the number by usage of the output parameter currentNumberClients. Additionally, the function SHALL return without raising an exception to indicate that the execution of the function has been successful.</originalText>
      <germanText>Gibt aktuelle Clientanzahl zurück. Bei Erfolg keine Exception.</germanText>
      <pseudocode>GEBE Clientanzahl zurück (currentNumberClients Parameter)
RETURN ohne Exception</pseudocode>
      <successCase>
        <condition>Die Ermittlung der aktuellen Clientanzahl war erfolgreich</condition>
        <action>Gibt Clientanzahl zurück und kehrt ohne Exception zurück</action>
      </successCase>
    </step>
  </detailedSteps>
  <parameters />
  <returnValue>
    <type>long</type>
    <description>the number of distinct clients that started or updated transactions that have not been finished.</description>
  </returnValue>
  <exceptions>
    <exception>ErrorCurrentNumberOfClientsNotTracked</exception>
    <exception>ErrorDeviceNotInitialized</exception>
    <exception>ErrorFunctionFailed</exception>
    <exception>ErrorFunctionNotSupported</exception>
    <exception>ErrorGetCurrentNumberOfClientsFailed</exception>
    <exception>ErrorParameterSyntax</exception>
    <exception>ErrorSecureElementDisabled</exception>
    <exception>ErrorUserNotAuthenticated</exception>
    <exception>ErrorUserNotAuthorized</exception>
  </exceptions>
</function>
