<?xml version='1.0' encoding='UTF-8' standalone='yes'?>
<exception xmlns="http://bsi.bund.de/TR03151" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="ErrorGetCurrentSignatureCounterFailed" xsi:schemaLocation="http://bsi.bund.de/TR03151 ../../schema/exceptions.xsd">
  <name>ErrorGetCurrentSignatureCounterFailed</name>
  <description>
    <text xml:lang="en">This exception is thrown if the SE API function getCurrentLoggingSignatureCounters fails to obtain the current signature counter values from the Secure Element's logging subsystem. The function attempts to retrieve the current state of cryptographic signature counters used for logging operations, but the retrieval process fails before the counter values can be determined and returned.</text>
    <text xml:lang="de">Diese Ausnahme wird ausgelöst, wenn die SE API Funktion getCurrentLoggingSignatureCounters fehlschlägt, um die aktuellen Signatur-Zählerwerte von dem Logging-Subsystem des Secure Element zu erhalten. Die Funktion versucht, den aktuellen Zustand kryptographischer Signatur-Zähler abzurufen, die für Logging-Operationen verwendet werden, aber der Abrufprozess schlägt fehl, bevor die Zählerwerte bestimmt und zurückgegeben werden können.</text>
  </description>
  <category>Logging</category>
  <subcategory>Signature Counter Management</subcategory>
  <severity>High</severity>
  <javadoc>
    <summary>
      <text xml:lang="en">This class defines the exception ErrorGetCurrentSignatureCounterFailed that is thrown if the SE API function getCurrentLoggingSignatureCounters fails to obtain the current signature counter values.</text>
      <text xml:lang="de">Diese Klasse definiert die Ausnahme ErrorGetCurrentSignatureCounterFailed, die ausgelöst wird, wenn die SE API Funktion getCurrentLoggingSignatureCounters fehlschlägt, um die aktuellen Signatur-Zählerwerte zu erhalten.</text>
    </summary>
    <description>
      <text xml:lang="en">This exception is thrown when the getCurrentLoggingSignatureCounters function cannot retrieve the current signature counter values from the Secure Element's logging subsystem. Signature counters are critical components of the logging infrastructure that track and validate the sequence and integrity of logged events. ErrorGetCurrentSignatureCounterFailed indicates that the Secure Element cannot provide the current counter state due to hardware failure, storage corruption, internal logging system errors, communication failures, or Secure Element state restrictions. When this exception occurs, no counter data is returned and applications cannot verify logging integrity or determine current counter state. Recovery typically involves device verification, logging subsystem diagnostics, potential counter reinitialization, and possible hardware diagnosis if the failure persists.</text>
      <text xml:lang="de">Diese Ausnahme wird ausgelöst, wenn die Funktion getCurrentLoggingSignatureCounters die aktuellen Signatur-Zählerwerte nicht aus dem Logging-Subsystem des Secure Element abrufen kann. Signatur-Zähler sind kritische Komponenten der Logging-Infrastruktur, die die Sequenz und Integrität von protokollierten Ereignissen nachverfolgen und validieren. ErrorGetCurrentSignatureCounterFailed zeigt an, dass das Secure Element den aktuellen Zählerzustand aufgrund eines Hardware-Ausfalls, Speicherbeschädigung, interner Logging-System-Fehler, Kommunikationsfehler oder Sicherheitselement-Zustandsbeschränkungen nicht bereitstellen kann. Wenn diese Ausnahme auftritt, werden keine Zählerdaten zurückgegeben und Anwendungen können die Logging-Integrität nicht verifizieren oder den aktuellen Zählerzustand nicht bestimmen. Die Wiederherstellung umfasst normalerweise Geräteverifizierung, Logging-Subsystem-Diagnose, mögliche Zähler-Reinitialisierung und mögliche Hardware-Diagnose, wenn der Fehler anhält.</text>
    </description>
  </javadoc>
  <specification>
    <source>BSI TR-03151-1</source>
    <section>3.2.6 Logging - getCurrentLoggingSignatureCounters</section>
    <requirement>
      <text xml:lang="en">The function getCurrentLoggingSignatureCounters SHALL retrieve the current signature counter values maintained by the Secure Element's logging subsystem. If the Secure Element cannot provide or return the required counter information, the function SHALL raise the exception ErrorGetCurrentSignatureCounterFailed and exit without returning any counter data. The signature counter retrieval failure indicates the Secure Element's logging counter query functionality could not complete successfully.</text>
      <text xml:lang="de">Die Funktion getCurrentLoggingSignatureCounters soll die aktuellen Signatur-Zählerwerte abrufen, die von dem Logging-Subsystem des Secure Element verwaltet werden. Falls das Secure Element die erforderlichen Zählerinformationen nicht bereitstellen oder zurückgeben kann, soll die Funktion die Ausnahme ErrorGetCurrentSignatureCounterFailed auslösen und beendet werden, ohne Zählerdaten zurückzugeben. Der Fehler bei der Signatur-Zählerabruf zeigt an, dass die Logging-Zählerabfrage-Funktionalität des Secure Element nicht erfolgreich abgeschlossen werden konnte.</text>
    </requirement>
    <applicability>
      <text xml:lang="en">Logging operations - getCurrentLoggingSignatureCounters function only</text>
      <text xml:lang="de">Logging-Operationen - nur Funktion getCurrentLoggingSignatureCounters</text>
    </applicability>
    <reference>getCurrentLoggingSignatureCounters – Function (3.2.6)</reference>
  </specification>
  <thrownBy>
    <function>getCurrentLoggingSignatureCounters</function>
  </thrownBy>
  <triggerConditions>
    <condition>
      <scenario>
        <text xml:lang="en">Signature counter storage hardware failure</text>
        <text xml:lang="de">Hardware-Fehler des Signatur-Zählerspeichers</text>
      </scenario>
      <description>
        <text xml:lang="en">The Secure Element's counter storage hardware malfunctions or becomes inaccessible, preventing counter value retrieval</text>
        <text xml:lang="de">Die Zählerspeicher-Hardware des Secure Element funktioniert nicht mehr oder wird nicht zugänglich, was den Zählerwertabruf verhindert</text>
      </description>
      <trigger>
        <text xml:lang="en">The Secure Element's counter storage hardware fails or experiences read errors. When getCurrentLoggingSignatureCounters is called, the counter retrieval query is sent to the Secure Element, but the hardware cannot provide valid counter data. The function receives a failure status from the Secure Element, triggering ErrorGetCurrentSignatureCounterFailed.</text>
        <text xml:lang="de">Die Zählerspeicher-Hardware des Secure Element schlägt fehl oder verursacht Lesefehler. Wenn getCurrentLoggingSignatureCounters aufgerufen wird, wird die Zählerabfrage-Abfrage an das Secure Element gesendet, aber die Hardware kann keine gültigen Zählerdaten bereitstellen. Die Funktion erhält einen Fehlerstatus vom Secure Element, das ErrorGetCurrentSignatureCounterFailed auslöst.</text>
      </trigger>
    </condition>
    <condition>
      <scenario>
        <text xml:lang="en">Logging subsystem counter storage corruption</text>
        <text xml:lang="de">Beschädigung des Logging-Subsystem Zählerspeichers</text>
      </scenario>
      <description>
        <text xml:lang="en">The Secure Element's logging subsystem counter storage becomes corrupted or data is lost</text>
        <text xml:lang="de">Der Logging-Subsystem Zählerspeicher des Secure Element wird beschädigt oder Daten gehen verloren</text>
      </description>
      <trigger>
        <text xml:lang="en">The Secure Element's memory containing counter data or logging state tables becomes corrupted, experiences data loss, or is marked as inaccessible due to storage errors. When getCurrentLoggingSignatureCounters attempts to read counter values from storage, the data cannot be reliably retrieved, triggering ErrorGetCurrentSignatureCounterFailed.</text>
        <text xml:lang="de">Der Speicher des Secure Element, der Zählerdaten oder Logging-Zustandstabellen enthält, wird beschädigt, erfährt Datenverluste oder wird aufgrund von Speicherfehlern als nicht zugänglich markiert. Wenn getCurrentLoggingSignatureCounters versucht, Zählerwerte aus dem Speicher zu lesen, können die Daten nicht zuverlässig abgerufen werden, was ErrorGetCurrentSignatureCounterFailed auslöst.</text>
      </trigger>
    </condition>
    <condition>
      <scenario>
        <text xml:lang="en">Logging subsystem internal error in counter calculation</text>
        <text xml:lang="de">Interner Fehler des Logging-Subsystems bei der Zählerberechnung</text>
      </scenario>
      <description>
        <text xml:lang="en">The Secure Element's logging subsystem encounters critical errors that prevent counter value calculation or retrieval</text>
        <text xml:lang="de">Das Logging-Subsystem des Secure Element trifft auf kritische Fehler, die die Zählerwertberechnung oder den Abruf verhindern</text>
      </description>
      <trigger>
        <text xml:lang="en">The Secure Element's logging management subsystem (responsible for maintaining counter values, updating counters on log events, and providing counter state) encounters an internal error, deadlock, or exception. When getCurrentLoggingSignatureCounters is called, the logging subsystem cannot process the counter query, triggering ErrorGetCurrentSignatureCounterFailed.</text>
        <text xml:lang="de">Das Logging-Management-Subsystem des Secure Element (verantwortlich für die Verwaltung von Zählerwerten, die Aktualisierung von Zählern bei Protokollereignissen und die Bereitstellung des Zählerzustands) trifft auf einen internen Fehler, Deadlock oder Ausnahme. Wenn getCurrentLoggingSignatureCounters aufgerufen wird, kann das Logging-Subsystem die Zählerabfrage nicht bearbeiten, was ErrorGetCurrentSignatureCounterFailed auslöst.</text>
      </trigger>
    </condition>
    <condition>
      <scenario>
        <text xml:lang="en">Device-to-Secure Element communication failure during counter query</text>
        <text xml:lang="de">Kommunikationsfehler zwischen Gerät und Secure Element während der Zählerabfrage</text>
      </scenario>
      <description>
        <text xml:lang="en">The communication channel between device and Secure Element is disrupted during signature counter retrieval</text>
        <text xml:lang="de">Der Kommunikationskanal zwischen Gerät und Secure Element wird während des Signatur-Zählerabrufs unterbrochen</text>
      </description>
      <trigger>
        <text xml:lang="en">A communication failure occurs while getCurrentLoggingSignatureCounters transmits the counter query to the Secure Element or while receiving the counter response. The command may be corrupted, the response may be incomplete, or the communication link may be temporarily unavailable. The function receives a communication error status, triggering ErrorGetCurrentSignatureCounterFailed.</text>
        <text xml:lang="de">Ein Kommunikationsfehler tritt auf, während getCurrentLoggingSignatureCounters die Zählerabfrage an das Secure Element übermättelt oder während die Zählerantwort empfangen wird. Der Befehl kann beschädigt sein, die Antwort kann unvollständig sein oder der Kommunikationskanal kann vorübergehend nicht verfügbar sein. Die Funktion erhält einen Kommunikationsfehler-Status, der ErrorGetCurrentSignatureCounterFailed auslöst.</text>
      </trigger>
    </condition>
    <condition>
      <scenario>
        <text xml:lang="en">Secure Element in restricted or error state prohibiting counter access</text>
        <text xml:lang="de">Secure Element im eingeschränkten oder fehlerhaften Zustand, der Zählerzugriff verhindert</text>
      </scenario>
      <description>
        <text xml:lang="en">The Secure Element is in a locked, restricted, or error state that prevents external queries for counter information</text>
        <text xml:lang="de">Das Secure Element ist im gesperrten, eingeschränkten oder fehlerhaften Zustand, der externe Abfragen für Zählerinformationen verhindert</text>
      </description>
      <trigger>
        <text xml:lang="en">The Secure Element enters a state where logging operations or logging counter access is not permitted. When getCurrentLoggingSignatureCounters is called and the Secure Element's state prohibits counter access, the function receives a state-related rejection, triggering ErrorGetCurrentSignatureCounterFailed.</text>
        <text xml:lang="de">Das Secure Element tritt in einen Zustand ein, in dem Logging-Operationen oder Logging-Zählerzugriff nicht zulässig sind. Wenn getCurrentLoggingSignatureCounters aufgerufen wird und der Zustand des Secure Element den Zählerzugriff verhindert, erhält die Funktion eine zustandsbezogene Ablehnung, die ErrorGetCurrentSignatureCounterFailed auslöst.</text>
      </trigger>
    </condition>
  </triggerConditions>
  <executionSequence>
    <step number="1">
      <text xml:lang="en">User/application calls getCurrentLoggingSignatureCounters function on device</text>
      <text xml:lang="de">Benutzer/Anwendung ruft die Funktion getCurrentLoggingSignatureCounters auf dem Gerät auf</text>
    </step>
    <step number="2">
      <text xml:lang="en">Function validates input parameters and checks authentication status (if required by referencing guideline)</text>
      <text xml:lang="de">Funktion validiert Eingabeparameter und prüft Authentifizierungsstatus (falls von Richtlinie erforderlich)</text>
    </step>
    <step number="3">
      <text xml:lang="en">Function checks authorization for counter information access (if required by referencing guideline)</text>
      <text xml:lang="de">Funktion prüft die Autorisierung für den Zählerinformationszugriff (falls von Richtlinie erforderlich)</text>
    </step>
    <step number="4">
      <text xml:lang="en">Function verifies device is properly initialized and logging subsystem is operational</text>
      <text xml:lang="de">Funktion verifiziert, dass das Gerät ordnungsgemäß initialisiert und das Logging-Subsystem betriebsbereit ist</text>
    </step>
    <step number="5">
      <text xml:lang="en">Function initiates communication channel to Secure Element and prepares counter query command</text>
      <text xml:lang="de">Funktion initiiert Kommunikationskanal zu Secure Element und bereitet Zählerabfrage-Befehl vor</text>
    </step>
    <step number="6">
      <text xml:lang="en">Function transmits counter query command to Secure Element requesting current signature counter values</text>
      <text xml:lang="de">Funktion übermättelt Zählerabfrage-Befehl zu Secure Element und fordert aktuelle Signatur-Zählerwerte an</text>
    </step>
    <step number="6a">
      <text xml:lang="en">If Secure Element responds with failure status (storage error, counter calculation error, subsystem error) → ErrorGetCurrentSignatureCounterFailed raised, function exits without counter data</text>
      <text xml:lang="de">Falls Secure Element mit Fehlerstatus antwortet (Speicherfehler, Zählerberechnungsfehler, Subsystem-Fehler) → ErrorGetCurrentSignatureCounterFailed ausgelöst, Funktion beendet ohne Zählerdaten</text>
    </step>
    <step number="6b">
      <text xml:lang="en">If communication failure occurs during query transmission or response reception → ErrorGetCurrentSignatureCounterFailed raised, function exits</text>
      <text xml:lang="de">Falls Kommunikationsfehler während Abfragetübertragung oder Antwortempfang auftritt → ErrorGetCurrentSignatureCounterFailed ausgelöst, Funktion beendet</text>
    </step>
    <step number="7">
      <text xml:lang="en">If successful, function receives counter values from Secure Element</text>
      <text xml:lang="de">Falls erfolgreich, empfängt Funktion Zählerwerte von Secure Element</text>
    </step>
    <step number="8">
      <text xml:lang="en">Function validates counter values for correctness (format, sequence, logical consistency)</text>
      <text xml:lang="de">Funktion validiert Zählerwerte auf Korrektheit (Format, Sequenz, logische Konsistenz)</text>
    </step>
    <step number="9">
      <text xml:lang="en">Function closes Secure Element communication channel</text>
      <text xml:lang="de">Funktion schließt Secure Element Kommunikationskanal</text>
    </step>
    <step number="10">
      <text xml:lang="en">Function returns valid counter values to caller</text>
      <text xml:lang="de">Funktion gibt gültige Zählerwerte an Aufrufer zurück</text>
    </step>
  </executionSequence>
  <recovery>
    <step>
      <text xml:lang="en">Verify device is initialized</text>
      <text xml:lang="de">Stellen Sie sicher, dass das Gerät initialisiert ist</text>
    </step>
    <step>
      <text xml:lang="en">Confirm Secure Element is operational</text>
      <text xml:lang="de">Bestätigen Sie, dass das Secure Element funktionsfähig ist</text>
    </step>
    <step>
      <text xml:lang="en">Retry counter query after confirming device state</text>
      <text xml:lang="de">Wiederholen Sie die Zählerabfrage nach Bestätigung des Gerätestatus</text>
    </step>
    <step>
      <text xml:lang="en">Check logging subsystem status</text>
      <text xml:lang="de">Prüfen Sie den Logging-Subsystem-Status</text>
    </step>
  </recovery>
  <relatedExceptions>
    <exception>ErrorFunctionFailed</exception>
    <exception>ErrorDeviceNotInitialized</exception>
    <exception>ErrorConfigureLoggingFailed</exception>
    <exception>ErrorExportLoggingCertificateFailed</exception>
    <exception>ErrorDeleteLogMessagesFailed</exception>
  </relatedExceptions>
  <postconditionality>
    <state name="Device Operational State">
      <text xml:lang="en">Device remains fully operational and unmodified. The failure to retrieve counter values does not affect device initialization state, logging operations, internal memory, stored data, or the ability to perform other operations. All device components remain in their pre-call state.</text>
      <text xml:lang="de">Das Gerät bleibt vollständig betriebsbereit und unmodifiziert. Das Fehlschalten beim Zählerwertabruf wirkt sich nicht auf den Geräteinitialisierungszustand, Logging-Operationen, den internen Speicher, die gespeicherten Daten oder die Fähigkeit zur Durchführung anderer Operationen aus. Alle Gerätekomponenten bleiben in ihrem Pre-Call-Zustand.</text>
    </state>
    <state name="Counter Data Return Status">
      <text xml:lang="en">No counter values are returned to the caller. The function exits without providing any counter information. Applications must not assume default or cached counter values; they must handle the exception as indicating counter information is unavailable.</text>
      <text xml:lang="de">Es werden keine Zählerwerte an den Aufrufer zurückgegeben. Die Funktion wird beendet, ohne Zählerinformationen bereitzustellen. Anwendungen dürfen nicht mit Standard- oder zwischengespeicherten Zählerwerten rechnen; sie müssen die Ausnahme als Anzeichen dafür behandeln, dass Zählerinformationen nicht verfügbar sind.</text>
    </state>
    <state name="Secure Element Logging State">
      <text xml:lang="en">Secure Element logging subsystem remains unchanged by the failed counter query. No state modifications, counter updates, or logging configuration changes occur. Logging operations continue internally in the Secure Element regardless of the retrieval failure.</text>
      <text xml:lang="de">Das Logging-Subsystem des Secure Element bleibt durch die fehlgeschlagene Zählerabfrage unverändert. Es werden keine Zustandseränderungen, Zählerspalten oder Logging-Konfigurationsoderänderungen vorgenommen. Logging-Operationen werden intern im Secure Element unabhängig vom Abruffehler fortgesetzt.</text>
    </state>
    <state name="Counter Advancement Continuity">
      <text xml:lang="en">Secure Element's signature counters continue to advance as logging events occur. The failure to retrieve counter values does not stop or pause counter tracking. Subsequent attempts to query counters or perform logging operations may succeed once the underlying issue is resolved.</text>
      <text xml:lang="de">Die Signatur-Zähler des Secure Element führen weiterhin fort, wenn Protokollereignisse auftreten. Das Fehlschalten beim Abruf von Zählerwerten stoppt oder pausiert die Zählerverfolgung nicht. Nachfolgende Versuche, Zähler abzufragen oder Logging-Operationen durchzuführen, können erfolgreich sein, sobald das zugrunde liegende Problem behoben ist.</text>
    </state>
    <state name="No Cascading State Effects">
      <text xml:lang="en">No cascading state inconsistencies or secondary failures occur as a result of the counter retrieval failure. Device internal consistency is maintained. Other SE API functions and logging operations continue normally without state corruption.</text>
      <text xml:lang="de">Es treten keine kaskadenförmigen Zustandsinkonsistenzen oder sekundäre Ausfallschlösse als Ergebnis des Zählerabruffehlers auf. Die interne Konsistenz des Geräts wird aufrechterhalten. Andere SE API Funktionen und Logging-Operationen funktionieren normal ohne Zustandsbeschädigung.</text>
    </state>
    <state name="Recovery Preconditions Met">
      <text xml:lang="en">The device state after exception is consistent and allows for recovery operations. The underlying issue (storage error, communication error, subsystem error) remains present, but the device is stable enough to accept diagnostic queries or recovery attempts.</text>
      <text xml:lang="de">Der Gerätezustand nach der Ausnahme ist konsistent und ermöglicht Wiederherstellungsoperationen. Das zugrunde liegende Problem (Speicherfehler, Kommunikationsfehler, Subsystem-Fehler) bleibt bestehen, aber das Gerät ist stabil genug, um Diagnoseversuche oder Wiederherstellungsversuche zu akzeptieren.</text>
    </state>
  </postconditionality>
  <notes>
    <note>
      <text xml:lang="en">Indication: Retrieval of current signature counter failed - cannot determine counter value</text>
      <text xml:lang="de">Anzeichen: Abruf des aktuellen Signatur-Zählers fehlgeschlagen - kann Zählerwert nicht bestimmen</text>
    </note>
    <note>
      <text xml:lang="en">Topics: Signature Operations, Counter Management, Information Retrieval, Logging State</text>
      <text xml:lang="de">Themen: Signatur-Operationen, Zählerverwaltung, Informationsabfrage, Logging-Zustand</text>
    </note>
  </notes>
  <usage>
    <scenario name="Scenario 1: Logging Integrity Verification Before Critical Operations">
      <description>
        <text xml:lang="en">An application must verify logging integrity by checking the current signature counter state before performing critical operations. The application retrieves the current logging counter values to establish a baseline. If ErrorGetCurrentSignatureCounterFailed is raised, the application cannot verify logging integrity and must conservatively reject critical operations to ensure audit trail security.</text>
        <text xml:lang="de">Eine Anwendung muss die Logging-Integrität verifizieren, indem sie den aktuellen Signatur-Zählerzustand vor der Durchführung kritischer Operationen prüft. Die Anwendung ruft die aktuellen Logging-Zählerwerte ab, um eine Baseline zu etablieren. Falls ErrorGetCurrentSignatureCounterFailed ausgelöst wird, kann die Anwendung die Logging-Integrität nicht verifizieren und muss kritische Operationen konservativ ablehnen, um die Sicherheit des Audit-Trail zu sichern.</text>
      </description>
      <relatedFunctions>
        <text xml:lang="en">getCurrentLoggingSignatureCounters, configureLogging, deleteLogMessages</text>
        <text xml:lang="de">getCurrentLoggingSignatureCounters, configureLogging, deleteLogMessages</text>
      </relatedFunctions>
      <errorContext>
        <text xml:lang="en">Signature counter state cannot be verified due to unavailable counter information</text>
        <text xml:lang="de">Der Signatur-Zählerzustand kann aufgrund nicht verfügbarer Zählerinformationen nicht verifiziert werden</text>
      </errorContext>
    </scenario>
    <scenario name="Scenario 2: Logging State Consistency Verification and Diagnostics">
      <description>
        <text xml:lang="en">An audit system monitors logging subsystem health by periodically querying signature counter values. The system uses counter values to verify that logging is operating correctly and counters are advancing as expected with each logged event. If ErrorGetCurrentSignatureCounterFailed is raised, the system logs this as a critical diagnostic indicator of potential logging subsystem compromise or hardware failure.</text>
        <text xml:lang="de">Ein Audit-System überwacht die Gesundheit des Logging-Subsystems, indem es regelmäßig Signatur-Zählerwerte abfragt. Das System verwendet Zählerwerte, um zu verifizieren, dass das Logging ordnungsgemäß funktioniert und Zähler mit jedem protokollierten Ereignis wie erwartet fortgeführt werden. Falls ErrorGetCurrentSignatureCounterFailed ausgelöst wird, protokolliert das System dies als kritischen Diagnoseindicator möglicher Logging-Subsystem-Kompromittierung oder Hardware-Fehlers.</text>
      </description>
      <relatedFunctions>
        <text xml:lang="en">getCurrentLoggingSignatureCounters, configureLogging, exportLoggingMessages</text>
        <text xml:lang="de">getCurrentLoggingSignatureCounters, configureLogging, exportLoggingMessages</text>
      </relatedFunctions>
      <errorContext>
        <text xml:lang="en">Signature counter values unavailable for logging health monitoring and consistency verification</text>
        <text xml:lang="de">Signatur-Zählerwerte nicht verfügbar für Logging-Gesundheitsüberwachung und Konsistenzverifizierung</text>
      </errorContext>
    </scenario>
    <scenario name="Scenario 3: Counter State Validation During Log Export Operations">
      <description>
        <text xml:lang="en">Before exporting logged events, an application retrieves current counter values to document the logging state at export time. This creates a checkpoint showing what portion of the audit trail is being exported. If ErrorGetCurrentSignatureCounterFailed is raised, the application cannot create this checkpoint and must either defer export or export without integrity metadata.</text>
        <text xml:lang="de">Vor dem Export von protokollierten Ereignissen ruft eine Anwendung aktuelle Zählerwerte ab, um den Logging-Zustand zur Exportzeit zu dokumentieren. Dies erstellt einen Kontrollpunkt, der zeigt, welcher Teil des Audit-Trail exportiert wird. Falls ErrorGetCurrentSignatureCounterFailed ausgelöst wird, kann die Anwendung diesen Kontrollpunkt nicht erstellen und muss entweder den Export verschieben oder ohne Integritätsmetadaten exportieren.</text>
      </description>
      <relatedFunctions>
        <text xml:lang="en">getCurrentLoggingSignatureCounters, exportLoggingMessages, exportLoggingCertificate</text>
        <text xml:lang="de">getCurrentLoggingSignatureCounters, exportLoggingMessages, exportLoggingCertificate</text>
      </relatedFunctions>
      <errorContext>
        <text xml:lang="en">Counter state checkpoint unavailable during logging export operation</text>
        <text xml:lang="de">Zählerzustand-Kontrollpunkt nicht verfügbar während der Logging-Exportoperation</text>
      </errorContext>
    </scenario>
    <scenario name="Scenario 4: Multi-Device Logging Synchronization and Audit Trail Coordination">
      <description>
        <text xml:lang="en">An enterprise system manages logging across multiple devices and must coordinate audit trails. The system queries getCurrentLoggingSignatureCounters on each device to create a synchronized view of logging state across the infrastructure. If ErrorGetCurrentSignatureCounterFailed is raised on one device, the system cannot synchronize logging state with that device and must flag it for investigation.</text>
        <text xml:lang="de">Ein Unternehmensystem verwaltet Logging über mehrere Geräte und muss Audit-Trails koordinieren. Das System fragt getCurrentLoggingSignatureCounters auf jedem Gerät ab, um eine synchronisierte Ansicht des Logging-Zustands über die Infrastruktur zu erstellen. Falls ErrorGetCurrentSignatureCounterFailed auf einem Gerät ausgelöst wird, kann das System den Logging-Zustand mit diesem Gerät nicht synchronisieren und muss es zur Untersuchung markieren.</text>
      </description>
      <relatedFunctions>
        <text xml:lang="en">getCurrentLoggingSignatureCounters, configureLogging</text>
        <text xml:lang="de">getCurrentLoggingSignatureCounters, configureLogging</text>
      </relatedFunctions>
      <errorContext>
        <text xml:lang="en">Signature counter values unavailable for multi-device logging synchronization</text>
        <text xml:lang="de">Signatur-Zählerwerte nicht verfügbar für Multi-Geräte-Logging-Synchronisierung</text>
      </errorContext>
    </scenario>
  </usage>
  <implementationContext>
    <note>
      <text xml:lang="en">Raised by getCurrentLoggingSignatureCounters when counter retrieval fails</text>
      <text xml:lang="de">Wird von getCurrentLoggingSignatureCounters ausgelöst, wenn der Zählerabruf fehlschlägt</text>
    </note>
    <note>
      <text xml:lang="en">Counter query function retrieves signature counter state</text>
      <text xml:lang="de">Zählerabfragefunktion ruft Signatur-Zählerzustand ab</text>
    </note>
    <note>
      <text xml:lang="en">Device maintains signature counter for logging operations</text>
      <text xml:lang="de">Das Gerät verwaltet Signatur-Zähler für Logging-Operationen</text>
    </note>
    <note>
      <text xml:lang="en">Retrieval failure prevents counter value access</text>
      <text xml:lang="de">Abruffehler verhindert Zählerwertezugriff</text>
    </note>
  </implementationContext>
</exception>

