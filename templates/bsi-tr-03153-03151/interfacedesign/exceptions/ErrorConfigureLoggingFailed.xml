<?xml version='1.0' encoding='UTF-8' standalone='yes'?>
<exception xmlns="http://bsi.bund.de/TR03151" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="ErrorConfigureLoggingFailed" xsi:schemaLocation="http://bsi.bund.de/TR03151 ../../schema/exceptions.xsd">
  <name>ErrorConfigureLoggingFailed</name>
  <description>This exception is thrown if the invocation of SE API function configureLogging failed to set the logging configuration for a specific event in a component. The exception represents a critical failure in the Secure Element's ability to apply event-based logging policies to its internal components and modules. ErrorConfigureLoggingFailed is raised when the Secure Element attempts to configure logging for a specified component and event pair, but encounters an internal error that prevents the configuration from being successfully applied. This exception indicates that the device's logging subsystem has rejected the configuration request due to device-level constraints, internal state inconsistencies, memory limitations, or Secure Element hardware/firmware errors. The exception is raised after the Secure Element has validated the configuration parameters but failed during the actual application of the logging settings to the component.</description>
  <category>Logging</category>
  <severity>High</severity>
  <javadoc>
    <summary>This class defines the exception ErrorConfigureLoggingFailed that is thrown if the invokation of SE API function configureLogging failed to set the configuration.</summary>
    <description>The configuration of the logging of device events failed. This exception is raised when the attempt to set the logging configuration for a specific event in a component fails due to an error in the Secure Element or device functionality.</description>
  </javadoc>
  <specification>
    <source>BSI TR-03151-1</source>
    <section>3.6.1.4</section>
    <requirement>SHALL be raised when setting the logging of an event in a component fails. If the execution fails, the function SHALL raise the exception ErrorConfigureLoggingFailed and exit the function.</requirement>
    <applicability>Logging configuration operations when event logging cannot be applied</applicability>
    <reference>configureLogging â€“ Exceptions (3.6.1.4)</reference>
  </specification>
  <thrownBy>
    <function>configureLogging</function>
  </thrownBy>
  <triggerConditions>
    <condition>
      <scenario>Secure Element internal error during configuration application</scenario>
      <description>The Secure Element accepts the logging configuration request (component name, event type, and logging level are valid), but encounters an internal error while attempting to apply the configuration to the target component. The error may originate from firmware limitations, hardware malfunction, or internal subsystem failures.</description>
      <trigger>Secure Element hardware or firmware error preventing configuration application</trigger>
    </condition>
    <condition>
      <scenario>Device memory or resource constraints</scenario>
      <description>The device has insufficient memory or resources to allocate for the new logging configuration. This can occur if the device's logging buffer is nearly full, the configuration table is at capacity, or memory fragmentation prevents allocation of required structures.</description>
      <trigger>Insufficient device memory or logging resource exhaustion</trigger>
    </condition>
    <condition>
      <scenario>Logging subsystem state inconsistency</scenario>
      <description>The Secure Element's logging subsystem has entered an inconsistent or error state that prevents new configurations from being applied. This can occur after failed previous configuration attempts, after device state transitions, or due to corruption in the logging configuration table.</description>
      <trigger>Logging subsystem in invalid state preventing configuration updates</trigger>
    </condition>
    <condition>
      <scenario>Component not accessible or unavailable</scenario>
      <description>The specified component exists and is valid, but is currently not accessible for configuration due to the component being in an error state, being actively processing events, or having been temporarily disabled by device firmware.</description>
      <trigger>Target component temporarily unavailable for configuration</trigger>
    </condition>
  </triggerConditions>
  <recovery>
    <step>Verify device is initialized before configuration attempts</step>
    <step>Check which events can be configured - some may not be configurable</step>
    <step>Retry configuration with valid event types</step>
    <step>Review logging configuration requirements in specification</step>
    <step>Contact device support if configuration remains unavailable</step>
  </recovery>
  <relatedExceptions>
    <exception>ErrorDeviceNotInitialized</exception>
    <exception>ErrorLoggingOfEventNotConfigurable</exception>
    <exception>ErrorFunctionFailed</exception>
  </relatedExceptions>
  <executionSequence>
    <step number="1" name="Function Invocation">Function entry point is reached with parameters for component name, event type, and desired logging level provided by the caller</step>
    <step number="2" name="Parameter Validation">The Secure Element validates that component name and event type are valid and correspond to known logging targets in the device configuration</step>
    <step number="3" name="Logging Level Validation">The logging level parameter is validated to ensure it is within the supported range and is appropriate for the specified component and event</step>
    <step number="4" name="Device State Check">The device verifies that it is in a state suitable for configuration updates (initialized, not in error state, and logging subsystem responsive)</step>
    <step number="5" name="Resource Availability Check">The device checks available memory and logging resource capacity to ensure sufficient space for the new configuration entry</step>
    <step number="6" name="Configuration Application Attempt">The device attempts to apply the logging configuration to the target component, creating or updating the configuration entry in the device's logging settings table</step>
    <step number="7a" name="Configuration Success">If configuration is successfully applied, execution continues to complete the function normally and return to caller with success status</step>
    <step number="7b" name="Configuration Failure">If the application of configuration fails due to hardware error, firmware limitation, or subsystem state issue, execution branches to step 8</step>
    <step number="8" name="Exception Context Preparation">Exception context is prepared including the component name, event type, logging level being configured, device state information, and error details from the logging subsystem</step>
    <step number="9" name="Exception Instance Creation">ErrorConfigureLoggingFailed exception instance is created with appropriate error message detailing the configuration failure</step>
    <step number="10" name="Exception Propagation">Exception is raised and propagated up the call stack to the calling application, allowing error handling at application level</step>
  </executionSequence>
  <postconditionality>
    <state name="Exception State">An ErrorConfigureLoggingFailed exception has been created and raised, containing the failed component name, event type, logging level, and diagnostic timestamp</state>
    <state name="Device Logging State">The device's logging configuration remains in its previous state. The configuration update has not been successfully applied. Depending on implementation, the logging subsystem may have created a partial entry or left configuration unchanged.</state>
    <state name="Logging Subsystem State">The logging subsystem may be in a degraded or inconsistent state. Subsequent logging configuration attempts may fail or succeed with reduced capability. The subsystem may require reinitialization to restore full functionality.</state>
    <state name="Resource State">Device resources (memory, configuration table slots) remain unchanged. No resources have been allocated for the failed configuration. If configuration was partially attempted, some resources may be in an indeterminate state.</state>
    <state name="Function Exit">The function exits abnormally via exception propagation without completing its intended configuration operation</state>
    <state name="Device Availability">The Secure Element remains available for subsequent API calls, although the logging subsystem may have limited or degraded functionality. The device itself has not failed; only the specific logging configuration operation was rejected.</state>
  </postconditionality>
  <notes>
    <note>Indication: Configuration of logging events failed during a configureLogging operation</note>
    <note>Topics: Logging Configuration, Event Management, System Configuration, SE API Settings</note>
  </notes>
  <usage>
    <scenario name="Scenario 1: Logging Configuration Failure During Startup">
      <description>An application attempts to configure event logging during device initialization, but the logging subsystem is not yet fully operational or encounters an error.</description>
      <relatedFunctions>configureLogging, initializeDevice, getDeviceHealth</relatedFunctions>
      <errorContext>Device initialization phase where logging subsystem configuration fails</errorContext>
    </scenario>
    <scenario name="Scenario 2: Resource Exhaustion in Logging Subsystem">
      <description>An application has been configuring multiple event logging targets, and after several successful configurations, the next configuration fails due to insufficient device resources or logging buffer exhaustion.</description>
      <relatedFunctions>configureLogging, getComponentVersions, exportLogMessages</relatedFunctions>
      <errorContext>Progressive resource depletion scenario where later configurations fail while earlier ones succeeded</errorContext>
    </scenario>
    <scenario name="Scenario 3: Recovery Through Logging Subsystem Reset">
      <description>An application encounters this exception and implements recovery by clearing existing logging configurations, waiting for device stabilization, and then retrying the configuration.</description>
      <relatedFunctions>configureLogging, deleteLogMessages, updateDevice</relatedFunctions>
      <errorContext>Recovery strategy focused on freeing resources and restoring logging subsystem state</errorContext>
    </scenario>
    <scenario name="Scenario 4: Proactive Health Checking Before Configuration">
      <description>An application proactively checks device health and available resources before attempting logging configuration to prevent this exception.</description>
      <relatedFunctions>configureLogging, getDeviceHealth, getComponentVersions</relatedFunctions>
      <errorContext>Defensive programming approach using device health status to prevent configuration failures</errorContext>
    </scenario>
  </usage>
  <implementationContext>
    <note>Raised by configureLogging when event configuration operation fails</note>
    <note>Logging configuration subsystem applies settings for specific event types</note>
    <note>Device attempts to enable/disable logging of configured events</note>
    <note>Configuration failure prevents logging behavior changes</note>
  </implementationContext>
</exception>
