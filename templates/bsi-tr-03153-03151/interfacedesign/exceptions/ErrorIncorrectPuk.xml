<?xml version='1.0' encoding='UTF-8' standalone='yes'?>
<exception xmlns="http://bsi.bund.de/TR03151" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="ErrorIncorrectPuk" xsi:schemaLocation="http://bsi.bund.de/TR03151 ../../schema/exceptions.xsd">
  <name>ErrorIncorrectPuk</name>
  <description>
    <text xml:lang="en">This exception is thrown if the SE API function unblockPin fails because an incorrect PUK (PIN Unblock Key) was provided. The function attempts to unblock a blocked PIN by verifying the supplied PUK, but the provided PUK does not match the registered PIN unblock credential, causing the unblock operation to fail and be rejected.</text>
    <text xml:lang="de">Diese Ausnahme wird ausgelöst, wenn die SE API Funktion unblockPin fehlschlägt, da ein falscher PUK (PIN Unblock Key) bereitgestellt wurde. Die Funktion versucht, eine blockierte PIN zu entsperren, indem der bereitgestellte PUK verifiziert wird, aber der bereitgestellte PUK stimmt nicht mit der registrierten PIN-Entsperr-Berechtigung überein, was dazu führt, dass die Entsperr-Operation fehlschlägt und abgelehnt wird.</text>
  </description>
  <category>Authentication</category>
  <subcategory>PIN Unblock Security</subcategory>
  <severity>High</severity>
  <javadoc>
    <summary>
      <text xml:lang="en">This class defines the exception ErrorIncorrectPuk that is thrown if the SE API function unblockPin has been invoked with an incorrect PUK.</text>
      <text xml:lang="de">Diese Klasse definiert die Ausnahme ErrorIncorrectPuk, die ausgelöst wird, wenn die SE API Funktion unblockPin mit einem falschen PUK aufgerufen worden ist.</text>
    </summary>
    <description>
      <text xml:lang="en">This exception is thrown when the unblockPin function receives an incorrect PUK that does not match the registered PIN unblock credential. PUK verification is a critical security operation that controls access to PIN unblock functionality and prevents unauthorized PIN reset attempts. ErrorIncorrectPuk indicates that the supplied PUK does not match the registered PIN Unblock Key stored on the Secure Element. When this exception occurs, the PIN unblock operation fails and the PIN remains blocked. The Secure Element may also track failed PUK verification attempts and implement security countermeasures (PUK retry counter decrement, potential PUK blocking after maximum failures). Recovery requires supplying the correct PUK in a subsequent unblock attempt, or requesting administrative assistance if the PUK is incorrect or unknown.</text>
      <text xml:lang="de">Diese Ausnahme wird ausgelöst, wenn die Funktion unblockPin einen falschen PUK erhält, der nicht mit der registrierten PIN-Entsperr-Berechtigung übereinstimmt. PUK-Verifizierung ist eine kritische Sicherheitsoperation, die den Zugriff auf PIN-Entsperr-Funktionalität kontrolliert und unautorisierte PIN-Zurücksetzen-Versuche verhindert. ErrorIncorrectPuk zeigt an, dass der bereitgestellte PUK nicht mit dem registrierten PIN Unblock Key auf dem Secure Element übereinstimmt. Wenn diese Ausnahme auftritt, schlägt die PIN-Entsperr-Operation fehl und die PIN bleibt blockiert. Das Secure Element kann auch fehlgeschlagene PUK-Verifizierungsversuche verfolgen und Sicherheitsmaßnahmen implementieren (PUK-Wiederholungszähler-Dekrement, potenzielle PUK-Blockierung nach maximalen Fehlern). Die Wiederherstellung erfordert die Bereitstellung des korrekten PUK bei einem nachfolgenden Entsperr-Versuch oder die Anforderung administrativer Unterstützung, wenn der PUK falsch oder unbekannt ist.</text>
    </description>
  </javadoc>
  <specification>
    <source>BSI TR-03151-1</source>
    <section>3.5.3 User Authentication - unblockPin</section>
    <requirement>
      <text xml:lang="en">The function unblockPin SHALL unblock a blocked PIN by verifying the provided PUK (PIN Unblock Key) against the registered PIN unblock credential. If the provided PUK does not match the registered credential, the function SHALL raise the exception ErrorIncorrectPuk and reject the PIN unblock operation without unblocking the PIN. The Secure Element SHALL track failed PUK verification attempts and may implement security countermeasures including PUK retry counter management.</text>
      <text xml:lang="de">Die Funktion unblockPin soll eine blockierte PIN entsperren, indem der bereitgestellte PUK (PIN Unblock Key) gegen die registrierte PIN-Entsperr-Berechtigung verifiziert wird. Falls der bereitgestellte PUK nicht mit der registrierten Berechtigung übereinstimmt, soll die Funktion die Ausnahme ErrorIncorrectPuk auslösen und die PIN-Entsperr-Operation ablehnen, ohne die PIN zu entsperren. Das Secure Element soll fehlgeschlagene PUK-Verifizierungsversuche verfolgen und kann Sicherheitsmaßnahmen implementieren, einschließlich PUK-Wiederholungszähler-Verwaltung.</text>
    </requirement>
    <applicability>
      <text xml:lang="en">PIN unblock operations - unblockPin function only</text>
      <text xml:lang="de">PIN-Entsperr-Operationen - nur Funktion unblockPin</text>
    </applicability>
    <reference>unblockPin – Function (3.5.3)</reference>
  </specification>
  <thrownBy>
    <function>unblockPin</function>
  </thrownBy>
  <triggerConditions>
    <condition>
      <scenario>
        <text xml:lang="en">User supplies incorrect PUK value</text>
        <text xml:lang="de">Benutzer gibt falschen PUK-Wert an</text>
      </scenario>
      <description>
        <text xml:lang="en">The user provides a PUK that does not match the registered PIN unblock credential</text>
        <text xml:lang="de">Der Benutzer gibt einen PUK an, der nicht mit der registrierten PIN-Entsperr-Berechtigung übereinstimmt</text>
      </description>
      <trigger>
        <text xml:lang="en">The user/application calls unblockPin with a PUK parameter that does not match the registered PIN Unblock Key stored on the Secure Element. The Secure Element verifies the supplied PUK against the registered credential and finds a mismatch. The verification fails and the Secure Element raises ErrorIncorrectPuk to reject the unblock operation.</text>
        <text xml:lang="de">Der Benutzer/die Anwendung ruft unblockPin mit einem PUK-Parameter auf, der nicht mit dem auf dem Secure Element gespeicherten registrierten PIN Unblock Key übereinstimmt. Das Secure Element verifiziert den bereitgestellten PUK gegen die registrierte Berechtigung und findet ein Missvhältnis. Die Verifizierung schlägt fehl und das Secure Element löst ErrorIncorrectPuk aus, um die Entsperr-Operation abzulehnen.</text>
      </trigger>
    </condition>
    <condition>
      <scenario>
        <text xml:lang="en">PUK verification failure due to typo or user error</text>
        <text xml:lang="de">PUK-Verifizierungsfehler aufgrund von Tippfehlern oder Benutzerfehlern</text>
      </scenario>
      <description>
        <text xml:lang="en">User accidentally enters an incorrect PUK due to typing error, transcription error, or other accidental input errors</text>
        <text xml:lang="de">Der Benutzer gibt versehentlich einen falschen PUK ein, aufgrund von Tipfehler, Transkriptionsfehler oder anderen versehentlichen Eingabefehlern</text>
      </description>
      <trigger>
        <text xml:lang="en">The user enters a PUK that is similar to but not identical to the correct PUK (single character difference, transposed digits, etc.). When unblockPin verifies the PUK, the mismatch is detected and ErrorIncorrectPuk is raised.</text>
        <text xml:lang="de">Der Benutzer gibt einen PUK ein, der ähnlich, aber nicht identisch mit dem korrekten PUK ist (einzelnes Zeichen-Unterschied, umgekehrte Ziffern, usw.). Wenn unblockPin den PUK verifiziert, wird das Missvhältnis erkannt und ErrorIncorrectPuk wird ausgelöst.</text>
      </trigger>
    </condition>
    <condition>
      <scenario>
        <text xml:lang="en">Malicious or brute force PIN unblock attempt</text>
        <text xml:lang="de">Bösartige oder Brute-Force-PIN-Entsperr-Versuch</text>
      </scenario>
      <description>
        <text xml:lang="en">An attacker attempts PIN unblock with incorrect PUKs in a brute force attack or denial of service attempt</text>
        <text xml:lang="de">Ein Angreifer versucht die PIN-Entsperrung mit falschen PUKs in einem Brute-Force-Angriff oder Denial-of-Service-Versuch</text>
      </description>
      <trigger>
        <text xml:lang="en">An attacker or unauthorized party calls unblockPin multiple times with various incorrect PUK values attempting to guess the correct PUK. Each incorrect PUK triggers ErrorIncorrectPuk. The Secure Element may track these repeated failures and implement security countermeasures including PUK blocking.</text>
        <text xml:lang="de">Ein Angreifer oder unberechtigte Partei ruft unblockPin mehrmals mit verschiedenen falschen PUK-Werten auf, versucht, den richtigen PUK zu erraten. Jeder falsche PUK löst ErrorIncorrectPuk aus. Das Secure Element kann diese wiederholten Fehler verfolgen und Sicherheitsmaßnahmen einschließlich PUK-Blockierung implementieren.</text>
      </trigger>
    </condition>
    <condition>
      <scenario>
        <text xml:lang="en">PIN unblock attempt with outdated or incorrect PUK credential</text>
        <text xml:lang="de">PIN-Entsperr-Versuch mit veralteter oder falscher PUK-Berechtigung</text>
      </scenario>
      <description>
        <text xml:lang="en">User attempts to use an incorrect or outdated PUK value (possibly from a previous device configuration or incorrect record)</text>
        <text xml:lang="de">Benutzer versucht, einen falschen oder veralteten PUK-Wert zu verwenden (möglicherweise von einer vorherigen Gerätekonfiguration oder falscher Aufzeichnung)</text>
      </description>
      <trigger>
        <text xml:lang="en">The user attempts PIN unblock using a PUK that was never valid, was changed through administrative procedures, or was misrecorded. When unblockPin verifies this PUK against the registered credential, the verification fails due to mismatch, triggering ErrorIncorrectPuk.</text>
        <text xml:lang="de">Der Benutzer versucht die PIN-Entsperrung mit einem PUK, der nie gültig war, durch administrative Verfahren geändert wurde oder falsch aufgezeichnet wurde. Wenn unblockPin diesen PUK gegen die registrierte Berechtigung verifiziert, schlägt die Verifizierung aufgrund des Missvhältnisses fehl und löst ErrorIncorrectPuk aus.</text>
      </trigger>
    </condition>
    <condition>
      <scenario>
        <text xml:lang="en">PUK verification with corrupted or incomplete PUK data</text>
        <text xml:lang="de">PUK-Verifizierung mit beschädigten oder unvollständigen PUK-Daten</text>
      </scenario>
      <description>
        <text xml:lang="en">The PIN unblock attempt uses a PUK that is incomplete, corrupted, or improperly formatted</text>
        <text xml:lang="de">Der PIN-Entsperr-Versuch verwendet einen PUK, der unvollständig, beschädigt oder fehlerhaft formatiert ist</text>
      </description>
      <trigger>
        <text xml:lang="en">The user supplies a PUK that is incomplete (fewer characters than required), corrupted (contains invalid characters), or improperly formatted. When the Secure Element verifies this PUK against the registered credential, the verification fails due to format/content mismatch, triggering ErrorIncorrectPuk.</text>
        <text xml:lang="de">Der Benutzer gibt einen PUK an, der unvollständig (weniger Zeichen als erforderlich), beschädigt (enthält ungültige Zeichen) oder fehlerhaft formatiert ist. Wenn das Secure Element diesen PUK gegen die registrierte Berechtigung verifiziert, schlägt die Verifizierung aufgrund von Format-/Inhalts-Konflikt fehl und löst ErrorIncorrectPuk aus.</text>
      </trigger>
    </condition>
  </triggerConditions>
  <executionSequence>
    <step number="1">
      <text xml:lang="en">User/application calls unblockPin function with PUK parameter</text>
      <text xml:lang="de">Benutzer/Anwendung ruft Funktion unblockPin mit PUK-Parameter auf</text>
    </step>
    <step number="2">
      <text xml:lang="en">Function validates input parameters including PUK format and length</text>
      <text xml:lang="de">Funktion validiert Eingabeparameter einschließlich PUK-Format und Länge</text>
    </step>
    <step number="3">
      <text xml:lang="en">Function checks if PIN is currently blocked and unblock operation is permitted</text>
      <text xml:lang="de">Funktion prüft, ob PIN derzeit blockiert ist und Entsperr-Operation zulässig ist</text>
    </step>
    <step number="4">
      <text xml:lang="en">Function verifies PIN unblock is applicable and PUK-based unblock is supported</text>
      <text xml:lang="de">Funktion verifiziert, dass PIN-Entsperrung anwendbar ist und PUK-basierte Entsperrung unterstützt wird</text>
    </step>
    <step number="5">
      <text xml:lang="en">Function initiates communication channel to Secure Element and prepares PIN unblock command with supplied PUK</text>
      <text xml:lang="de">Funktion initiiert Kommunikationskanal zu Secure Element und bereitet PIN-Entsperr-Befehl mit bereitgestelltem PUK vor</text>
    </step>
    <step number="6">
      <text xml:lang="en">Function transmits unblock command to Secure Element with supplied PUK for verification</text>
      <text xml:lang="de">Funktion übersendet Entsperr-Befehl zu Secure Element mit bereitgestelltem PUK zur Verifizierung</text>
    </step>
    <step number="6a">
      <text xml:lang="en">If supplied PUK does NOT match registered credential → Secure Element responds with failure, ErrorIncorrectPuk raised, function exits</text>
      <text xml:lang="de">Falls bereitgestellter PUK NICHT mit registrierter Berechtigung übereinstimmt → Secure Element antwortet mit Fehler, ErrorIncorrectPuk ausgelöst, Funktion beendet</text>
    </step>
    <step number="6b">
      <text xml:lang="en">If PUK verification confirms mismatch → Secure Element increments failed PUK verification counter and may apply security countermeasures</text>
      <text xml:lang="de">Falls PUK-Verifizierung Missvhältnis bestätigt → Secure Element erhöht fehlgeschlagenen PUK-Verifizierungs-Zähler und kann Sicherheitsmaßnahmen anwenden</text>
    </step>
    <step number="7">
      <text xml:lang="en">If supplied PUK matches registered credential, function receives unblock success confirmation</text>
      <text xml:lang="de">Falls bereitgestellter PUK mit registrierter Berechtigung übereinstimmt, empfängt Funktion Entsperr-Erfolgsbestätigung</text>
    </step>
    <step number="8">
      <text xml:lang="en">Function clears the PIN block flag and resets the PIN retry counter to allow new authentication attempts</text>
      <text xml:lang="de">Funktion löscht das PIN-Blockierungs-Flag und setzt den PIN-Wiederholungs-Zähler zurück, um neue Authentifizierungsversuche zu ermöglichen</text>
    </step>
    <step number="9">
      <text xml:lang="en">Function closes Secure Element communication channel</text>
      <text xml:lang="de">Funktion schließt Secure Element Kommunikationskanal</text>
    </step>
    <step number="10">
      <text xml:lang="en">Function returns to caller with PIN unblocked and ready for new authentication attempts</text>
      <text xml:lang="de">Funktion kehrt zum Aufrufer zurück mit entsperrter PIN und bereit für neue Authentifizierungsversuche</text>
    </step>
  </executionSequence>
  <recovery>
    <step>
      <text xml:lang="en">Verify PUK entry - check for typos</text>
      <text xml:lang="de">PUK-Eingabe verifizieren - auf Tippfehler prüfen</text>
    </step>
    <step>
      <text xml:lang="en">Retry unblock operation with correct PUK</text>
      <text xml:lang="de">Entsperr-Operation mit korrektem PUK wiederholen</text>
    </step>
    <step>
      <text xml:lang="en">If PUK forgotten, contact device vendor or support</text>
      <text xml:lang="de">Falls PUK vergessen, kontaktieren Sie den Gerätehersteller oder Support</text>
    </step>
  </recovery>
  <relatedExceptions>
    <exception>ErrorPukBlocked</exception>
    <exception>ErrorPinBlocked</exception>
    <exception>ErrorUserNotAuthenticated</exception>
    <exception>ErrorUnblockPinFailed</exception>
    <exception>ErrorFunctionNotSupported</exception>
  </relatedExceptions>
  <postconditionality>
    <state name="PIN Block Status">
      <text xml:lang="en">PIN remains blocked. The failed PUK verification does not unblock the PIN or reset the PIN block status. The device continues to prevent user authentication until the correct PUK is supplied in a subsequent unblock attempt.</text>
      <text xml:lang="de">PIN bleibt blockiert. Die fehlgeschlagene PUK-Verifizierung entsperrt die PIN nicht und setzt den PIN-Blockierungs-Status nicht zurück. Das Gerät setzt die Verhinderung der Benutzer-Authentifizierung fort, bis der richtige PUK in einem nachfolgenden Entsperr-Versuch bereitgestellt wird.</text>
    </state>
    <state name="Failed PUK Verification Counter Update">
      <text xml:lang="en">The Secure Element's failed PUK verification counter is typically incremented to track the PUK verification failure. If implemented, this counter tracks repeated failed attempts and may trigger security countermeasures (PUK blocking) after excessive failures.</text>
      <text xml:lang="de">Der fehlgeschlagene PUK-Verifizierungs-Zähler des Secure Element wird normalerweise erhöht, um den PUK-Verifizierungsfehler zu verfolgen. Falls implementiert, verfolgt dieser Zähler wiederholte Fehlerversuche und kann Sicherheitsmaßnahmen (PUK-Blockierung) nach übermäßigen Fehlern auslösen.</text>
    </state>
    <state name="PUK Blocking Preconditions">
      <text xml:lang="en">Repeated failed PUK verification attempts may eventually trigger PUK blocking or permanent PIN lock. If the failed attempt counter reaches the maximum threshold configured for PUK blocking, the next unblockPin call may raise ErrorPukBlocked instead of ErrorIncorrectPuk.</text>
      <text xml:lang="de">Wiederholte fehlgeschlagene PUK-Verifizierungsversuche können letztendlich PUK-Blockierung oder permanente PIN-Sperren auslösen. Falls der fehlgeschlagene Versuchs-Zähler den für PUK-Blockierung konfigurierten maximalen Schwellenwert erreicht, kann der nächste unblockPin-Aufruf ErrorPukBlocked statt ErrorIncorrectPuk auslösen.</text>
    </state>
    <state name="No Credential Modification">
      <text xml:lang="en">The registered PIN unblock credential (PUK) remains unchanged. The incorrect PUK does not modify the registered credential or authentication configuration. Subsequent unblock attempts use the same registered PUK credential.</text>
      <text xml:lang="de">Die registrierte PIN-Entsperr-Berechtigung (PUK) bleibt unverändert. Der falsche PUK ändert nicht die registrierte Berechtigung oder Authentifizierungs-Konfiguration. Nachfolgende Entsperr-Versuche verwenden dieselbe registrierte PUK-Berechtigung.</text>
    </state>
    <state name="Device Operational State">
      <text xml:lang="en">Device remains fully operational and unmodified. The failed unblock does not affect device state, configuration, or other operations. All device components remain in their pre-call state.</text>
      <text xml:lang="de">Das Gerät bleibt vollständig betriebsbereit und unmodifiziert. Das Fehlschlagen der Entsperrung wirkt sich nicht auf den Gerätezustand, die Konfiguration oder andere Operationen aus. Alle Gerätekomponenten bleiben in ihrem Pre-Call-Zustand.</text>
    </state>
    <state name="Recovery Preconditions Met">
      <text xml:lang="en">The device state after exception is consistent and allows for recovery operations. User can immediately retry PIN unblock with the correct PUK. No special recovery procedures are required unless PUK blocking is triggered or administrative assistance is needed.</text>
      <text xml:lang="de">Der Gerätezustand nach der Ausnahme ist konsistent und ermöglicht Wiederherstellungsoperationen. Der Benutzer kann sofort die PIN-Entsperrung mit dem korrekten PUK wiederholen. Keine speziellen Wiederherstellungsverfahren sind erforderlich, außer wenn PUK-Blockierung ausgelöst wird oder administrative Unterstützung erforderlich ist.</text>
    </state>
  </postconditionality>
  <notes>
    <note>
      <text xml:lang="en">Indication: PUK provided does not match the stored PUK - PUK verification failed</text>
      <text xml:lang="de">Anzeichen: Bereitgestellter PUK stimmt nicht mit dem gespeicherten PUK überein - PUK-Verifizierung fehlgeschlagen</text>
    </note>
    <note>
      <text xml:lang="en">Topics: Authentication, PIN Management, User Verification, Unblocking Operations</text>
      <text xml:lang="de">Themen: Authentifizierung, PIN-Verwaltung, Benutzerverfizierung, Entsperr-Operationen</text>
    </note>
  </notes>
  <usage>
    <scenario name="Scenario 1: PIN Unblock Recovery and Access Restoration">
      <description>
        <text xml:lang="en">A user has a blocked PIN and needs to restore access by providing the PUK for PIN unblock. The system calls unblockPin with the user-supplied PUK. If ErrorIncorrectPuk is raised, the system informs the user that the PUK is incorrect and prompts for retry. Correct PUK entry unblocks the PIN and allows new authentication attempts.</text>
        <text xml:lang="de">Ein Benutzer hat eine blockierte PIN und muss den Zugriff durch Bereitstellung des PUK zur PIN-Entsperrung wiederherstellen. Das System ruft unblockPin mit dem vom Benutzer bereitgestellten PUK auf. Falls ErrorIncorrectPuk ausgelöst wird, teilt das System dem Benutzer mit, dass der PUK falsch ist und fordert zur Wiederholung auf. Die richtige PUK-Eingabe entsperrt die PIN und ermöglicht neue Authentifizierungsversuche.</text>
      </description>
      <relatedFunctions>
        <text xml:lang="en">unblockPin, authenticateUser</text>
        <text xml:lang="de">unblockPin, authenticateUser</text>
      </relatedFunctions>
      <errorContext>
        <text xml:lang="en">Incorrect PUK supplied during PIN unblock recovery</text>
        <text xml:lang="de">Falscher PUK bereitgestellt während PIN-Entsperr-Wiederherstellung</text>
      </errorContext>
    </scenario>
    <scenario name="Scenario 2: Multi-Attempt PIN Unblock with User Guidance">
      <description>
        <text xml:lang="en">A user interface guides users through PUK entry and PIN unblock recovery. When unblockPin raises ErrorIncorrectPuk, the UI displays an error message and allows the user to retry. The UI tracks the number of failed attempts and warns users when approaching the PUK blocking threshold.</text>
        <text xml:lang="de">Eine Benutzeroberfläche führt Benutzer durch PUK-Eingabe und PIN-Entsperr-Wiederherstellung. Wenn unblockPin ErrorIncorrectPuk auslöst, zeigt die Oberfläche eine Fehlermeldung an und ermöglicht dem Benutzer Wiederholung. Die Oberfläche verfolgt die Anzahl der Fehlversuche und warnt Benutzer, wenn sie sich dem PUK-Blockierungs-Schwellenwert nähern.</text>
      </description>
      <relatedFunctions>
        <text xml:lang="en">unblockPin, authenticateUser</text>
        <text xml:lang="de">unblockPin, authenticateUser</text>
      </relatedFunctions>
      <errorContext>
        <text xml:lang="en">PUK verification failure with user retry capability</text>
        <text xml:lang="de">PUK-Verifizierungsfehler mit Benutzer-Wiederholungs-Fähigkeit</text>
      </errorContext>
    </scenario>
    <scenario name="Scenario 3: PIN Unblock Security Monitoring and Brute Force Detection">
      <description>
        <text xml:lang="en">A security monitoring system logs all PIN unblock attempts and detects potential brute force PIN unblock attacks. When ErrorIncorrectPuk is raised, the monitoring system logs the failure, tracks the source, and identifies suspicious patterns. If multiple failed unblock attempts occur from the same source in short time, the system triggers security alerts.</text>
        <text xml:lang="de">Ein Sicherheits-Überwachungssystem protokolliert alle PIN-Entsperr-Versuche und erkennt potenzielle Brute-Force-PIN-Entsperr-Angriffe. Wenn ErrorIncorrectPuk ausgelöst wird, protokolliert das Überwachungssystem den Fehler, verfolgt die Quelle und identifiziert verdächtige Muster. Falls mehrere Entsperr-Fehlerversuche aus der gleichen Quelle in kurzer Zeit auftreten, löst das System Sicherheitswarnungen aus.</text>
      </description>
      <relatedFunctions>
        <text xml:lang="en">unblockPin</text>
        <text xml:lang="de">unblockPin</text>
      </relatedFunctions>
      <errorContext>
        <text xml:lang="en">PIN unblock failure monitoring and brute force attack detection</text>
        <text xml:lang="de">PIN-Entsperr-Fehler-Überwachung und Brute-Force-Angriff-Erkennung</text>
      </errorContext>
    </scenario>
    <scenario name="Scenario 4: Automated PIN Unblock with Administrative Override">
      <description>
        <text xml:lang="en">An administrative system performs PIN unblock operations on behalf of users. When unblockPin raises ErrorIncorrectPuk, the system logs the failure, verifies the PUK in administrative records, and determines whether to retry or escalate to administrator. After excessive failures, the system requests administrator intervention for PUK verification.</text>
        <text xml:lang="de">Ein administratives System führt PIN-Entsperr-Operationen im Namen von Benutzern durch. Wenn unblockPin ErrorIncorrectPuk auslöst, protokolliert das System den Fehler, verifiziert den PUK in administrativen Aufzeichnungen und bestimmt, ob die Operation wiederholt oder zur Eskalation an den Administrator erfolgt. Nach übermäßigen Fehlern fordert das System administrator Eingriff für PUK-Verifizierung an.</text>
      </description>
      <relatedFunctions>
        <text xml:lang="en">unblockPin, authenticateUser</text>
        <text xml:lang="de">unblockPin, authenticateUser</text>
      </relatedFunctions>
      <errorContext>
        <text xml:lang="en">Administrative PIN unblock with retry and escalation handling</text>
        <text xml:lang="de">Administrative PIN-Entsperrung mit Wiederholung und Eskalations-Behandlung</text>
      </errorContext>
    </scenario>
  </usage>
  <implementationContext>
    <note>
      <text xml:lang="en">Raised by unblockPin when provided PUK does not match stored PUK</text>
      <text xml:lang="de">Wird von unblockPin ausgelöst, wenn der bereitgestellte PUK nicht mit dem gespeicherten PUK übereinstimmt</text>
    </note>
    <note>
      <text xml:lang="en">Unblock function verifies PUK before allowing PIN reset</text>
      <text xml:lang="de">Entsperr-Funktion verifiziert PUK vor dem Zulassen des PIN-Zurüksetzens</text>
    </note>
    <note>
      <text xml:lang="en">Device maintains PUK secret for PIN recovery</text>
      <text xml:lang="de">Gerät verwaltet PUK-Geheimnis für PIN-Wiederherstellung</text>
    </note>
    <note>
      <text xml:lang="en">PUK mismatch prevents PIN unblocking</text>
      <text xml:lang="de">PUK-Missvhältnis verhindert PIN-Entsperrung</text>
    </note>
  </implementationContext>
</exception>

