<?xml version='1.0' encoding='UTF-8' standalone='yes'?>
<exception xmlns="http://bsi.bund.de/TR03151" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="ErrorLoggingOfEventNotConfigurable" xsi:schemaLocation="http://bsi.bund.de/TR03151 ../../schema/exceptions.xsd">
  <name>ErrorLoggingOfEventNotConfigurable</name>
  <description>This exception is thrown if the SE API function configureLogging fails because the specified event type is not configurable for logging. The function attempts to modify the logging configuration for a specific event type, but that event type does not support logging configuration changes on this device. ErrorLoggingOfEventNotConfigurable indicates that the event type is either not loggable at all, has a fixed logging configuration that cannot be changed, or is a system event that is not subject to user configuration.</description>
  <category>Event Logging - Configuration Constraints</category>
  <severity>Medium</severity>
  <javadoc>
    <summary>This class defines the exception ErrorLoggingOfEventNotConfigurable that is thrown if the specified event is not configurable for logging.</summary>
    <description>This exception is thrown when the configureLogging function attempts to modify the logging configuration for an event type that is not configurable. Different event types have different logging properties - some events can have their logging enabled/disabled or configured, while others have fixed logging behavior that cannot be changed. ErrorLoggingOfEventNotConfigurable indicates that the specified event type does not support logging configuration changes. This may be because the event is marked as "must always be logged", the event type is not supported for logging at all, or the event has device-specific fixed logging behavior. Recovery requires identifying which event types are configurable on the device and modifying the configuration to only target those event types.</description>
    <constructors>
      <constructor>
        <signature>ErrorLoggingOfEventNotConfigurable()</signature>
        <description>Constructs a new ErrorLoggingOfEventNotConfigurable exception with null as the value for its detail message</description>
      </constructor>
      <constructor>
        <signature>ErrorLoggingOfEventNotConfigurable(String message)</signature>
        <description>Constructs a new ErrorLoggingOfEventNotConfigurable exception whereby its detail message is initialized with the passed value</description>
        <parameter name="message">value for the detail message of the exception, typically identifying which event type is not configurable</parameter>
      </constructor>
      <constructor>
        <signature>ErrorLoggingOfEventNotConfigurable(String message, Throwable cause)</signature>
        <description>Constructs a new ErrorLoggingOfEventNotConfigurable exception whereby its detail message and cause are initialized with the appropriate passed values</description>
        <parameter name="message">value for the detail message of the exception</parameter>
        <parameter name="cause">value for the cause of the exception</parameter>
      </constructor>
      <constructor>
        <signature>ErrorLoggingOfEventNotConfigurable(String message, Throwable cause, boolean enableSuppression, boolean writableStackTrace)</signature>
        <description>Constructs a new ErrorLoggingOfEventNotConfigurable exception whereby its detail message and cause are initialized with the appropriate passed values. Furthermore, it is specified whether or not suppression should be enabled or disabled and whether or not the stack trace should be writable for this exception.</description>
        <parameter name="message">value for the detail message of the exception</parameter>
        <parameter name="cause">value for the cause of the exception</parameter>
        <parameter name="enableSuppression">specifies whether or not suppression should be enabled for this exception</parameter>
        <parameter name="writableStackTrace">specifies whether or not the stack trace should be writable for this exception</parameter>
      </constructor>
    </constructors>
  </javadoc>
  <specification>
    <source>BSI TR-03151-1</source>
    <section>3.3.1 Event Logging Management - configureLogging</section>
    <requirement>The function configureLogging SHALL modify the logging configuration for specified event types. However, not all event types are configurable. If the specified event type is not configurable (either because it must always be logged, is not supported for logging, or has fixed device-specific logging behavior), the function SHALL raise the exception ErrorLoggingOfEventNotConfigurable. Configuration changes shall not be applied to non-configurable events.</requirement>
    <applicability>Event logging configuration operations - configureLogging function only, for non-configurable events</applicability>
    <reference>configureLogging – Function (3.3.1)</reference>
  </specification>
  <thrownBy>
    <function>configureLogging</function>
  </thrownBy>
  <triggerConditions>
    <condition>
      <scenario>Event type marked as mandatory logging</scenario>
      <description>The specified event type is marked in the device configuration as "must always be logged" and does not support configuration changes</description>
      <trigger>The configureLogging function attempts to modify logging settings for an event type that is designated as mandatory-log. The device's event logging policy specifies this event type must always be logged regardless of configuration. The function rejects the configuration attempt and raises ErrorLoggingOfEventNotConfigurable.</trigger>
    </condition>
    <condition>
      <scenario>Event type not supported for logging on this device</scenario>
      <description>The specified event type is not supported by the device's event logging subsystem</description>
      <trigger>The configureLogging function receives an event type identifier that is not recognized or not supported by the device's logging subsystem. The device cannot perform logging configuration for event types it does not support. ErrorLoggingOfEventNotConfigurable is raised.</trigger>
    </condition>
    <condition>
      <scenario>Event with fixed device-specific logging configuration</scenario>
      <description>The event type has a fixed, device-specific logging configuration that cannot be changed by configureLogging</description>
      <trigger>The Secure Element has certain event types with fixed logging behavior determined at manufacturing or initialization time. These event types cannot have their logging configuration modified. The configureLogging function detects the attempt to configure a fixed-configuration event type and raises ErrorLoggingOfEventNotConfigurable.</trigger>
    </condition>
    <condition>
      <scenario>System or reserved events not subject to user configuration</scenario>
      <description>The specified event type is a system or reserved event that is not permitted to have user-configurable logging settings</description>
      <trigger>The event type is classified as a system event, security-critical event, or reserved event that the device does not permit to be configured via the public SE API. The configureLogging function identifies this restriction and raises ErrorLoggingOfEventNotConfigurable.</trigger>
    </condition>
    <condition>
      <scenario>Event logging subsystem does not support per-event configuration</scenario>
      <description>The device's logging subsystem does not support per-event configuration - all logging is managed globally</description>
      <trigger>Some devices may have simplified logging subsystems that only support global enable/disable of logging without per-event configuration. An attempt to configure specific event types on such a device triggers ErrorLoggingOfEventNotConfigurable.</trigger>
    </condition>
  </triggerConditions>
  <executionSequence>
    <step number="1">User/application calls configureLogging function with event type and logging configuration parameters</step>
    <step number="2">Function validates input parameters including event type identifier and configuration values</step>
    <step number="3">Function checks device authorization and caller permissions for logging management</step>
    <step number="4">Function queries device for the list of configurable event types</step>
    <step number="5">Function checks if the specified event type is in the configurable event types list</step>
    <step number="5a">If event type is NOT configurable → ErrorLoggingOfEventNotConfigurable raised, function exits</step>
    <step number="5b">If event type IS configurable → proceed to step 6</step>
    <step number="6">Function validates the requested configuration parameters for the specific event type</step>
    <step number="7">Function initiates communication with Secure Element</step>
    <step number="8">Function transmits the logging configuration command to Secure Element</step>
    <step number="9">Function receives acknowledgment from Secure Element confirming configuration change</step>
    <step number="10">Function updates internal logging configuration cache</step>
    <step number="11">Function closes Secure Element communication channel</step>
    <step number="12">Function returns successfully with new logging configuration applied</step>
  </executionSequence>
  <recovery>
    <step>Identify configurable event types - query the device to determine which event types support logging configuration</step>
    <step>Review event type specification - consult device specifications or BSI TR-03151-1 documentation for the event type that was rejected</step>
    <step>Check device logging capabilities - determine if the device supports per-event logging configuration or only global logging control</step>
    <step>Verify event type identifier - ensure the event type parameter passed to configureLogging is correct and valid</step>
    <step>List available events - call getEventTypesForLogging or similar function to retrieve the list of available and configurable events</step>
    <step>Filter configuration targets - modify the logging configuration logic to only target event types that are configurable</step>
    <step>Retry with valid event types - attempt configureLogging again using only event types confirmed to be configurable</step>
    <step>Implement configuration skipping - if certain events must not be configurable, implement logic to skip those event types gracefully</step>
    <step>Log configuration attempt - record which event types were not configurable for diagnostic purposes</step>
    <step>If persistent, review device policy - examine device logging policy and design to understand logging configuration constraints</step>
  </recovery>
  <relatedExceptions>
    <exception>ErrorConfigureLoggingFailed</exception>
    <exception>ErrorGetEventTypesForLoggingFailed</exception>
    <exception>ErrorGetEventLoggingStatusFailed</exception>
    <exception>ErrorInvalidEventType</exception>
    <exception>ErrorFunctionFailed</exception>
  </relatedExceptions>
  <postconditionality>
    <state name="Logging Configuration Unchanged">The logging configuration for the specified event type remains in its state prior to the failed configureLogging call. No partial configuration changes occur. The configuration for that event type is not modified.</state>
    <state name="Other Event Configurations Unaffected">The logging configuration for other event types remains unchanged. The failure to configure one event type does not affect configurations for other events.</state>
    <state name="Device State Unmodified">The device's overall state remains unchanged by the failed configuration attempt. The event logging subsystem continues to function normally.</state>
    <state name="Event Logging Continues">The event logging continues to operate with the event's original or fixed logging settings. The fact that configuration is not available does not prevent logging from occurring.</state>
    <state name="Authorization State Preserved">The caller's authorization and credentials remain unchanged. The exception indicates a configuration capability constraint, not an authorization failure.</state>
    <state name="Reconfiguration Possible for Other Events">Other events that are configurable can still have their logging configuration modified via configureLogging calls.</state>
  </postconditionality>
  <notes>
    <note>ErrorLoggingOfEventNotConfigurable is thrown ONLY by the configureLogging function - it is the specific exception for non-configurable event types</note>
    <note>This exception indicates a capability constraint - the event type simply does not support configuration changes</note>
    <note>The set of configurable event types is device-specific and may vary between different Secure Element implementations</note>
    <note>Some event types may be mandatory-log by device policy or security requirements and therefore are not configurable</note>
    <note>Applications should query available configurable event types before attempting to configure logging</note>
    <note>This exception has Medium severity because it indicates a configuration incompatibility, not a system failure</note>
    <note>The error message should identify which event type is not configurable to help applications implement appropriate filtering</note>
    <note>Device specifications should document which event types are configurable and which have fixed behavior</note>
    <note>Some implementations may provide a list of configurable event types that can be queried to prevent configuration attempts on non-configurable events</note>
    <note>Configuration of multiple events should handle ErrorLoggingOfEventNotConfigurable gracefully by skipping non-configurable events</note>
    <note>Event type identifiers should be validated against the device's supported event types before attempting configuration</note>
    <note>Different event types may have different configuration options (enable/disable, log level, filter settings, etc.) - not all options are configurable for all events</note>
    <note>The concept of "configurable" applies to the ability to change logging behavior - mandatory events are logging regardless of configuration</note>
    <note>Device manufacturers should document the event logging configuration matrix identifying which events support which configuration options</note>
    <note>Applications should implement robust error handling for non-configurable events to support multiple device types with different capabilities</note>
  </notes>
  <usage>
    <scenario name="Scenario 1: Adaptive Logging Configuration with Event Type Discovery">
      <description>An application attempts to configure logging for a set of event types discovered at runtime. When configureLogging raises ErrorLoggingOfEventNotConfigurable for a specific event, the application catches the exception, removes that event from the configurable set, and continues configuration of the remaining events.</description>
      <relatedFunctions>configureLogging, getEventTypesForLogging, getEventLoggingStatus</relatedFunctions>
      <errorContext>Non-configurable event detected and skipped gracefully</errorContext>
    </scenario>
    <scenario name="Scenario 2: Logging Policy Enforcement with Device Constraints">
      <description>A compliance application implements a logging policy to configure event logging according to regulatory requirements. When ErrorLoggingOfEventNotConfigurable is raised, the application checks whether the non-configurable event's fixed logging behavior still meets compliance requirements. If not, the application fails with an error or alerts the operator.</description>
      <relatedFunctions>configureLogging, getEventLoggingStatus, getEventTypesForLogging</relatedFunctions>
      <errorContext>Non-configurable event blocks compliance policy enforcement</errorContext>
    </scenario>
    <scenario name="Scenario 3: Multi-Device Logging Configuration with Device-Specific Adaptation">
      <description>An enterprise system manages event logging across multiple different Secure Element types. Each device has different configurable event types. When ErrorLoggingOfEventNotConfigurable is raised, the application adapts the logging configuration to the specific device's capabilities by filtering the configuration to only target configurable events.</description>
      <relatedFunctions>configureLogging, getEventTypesForLogging</relatedFunctions>
      <errorContext>Device-specific capabilities adapted to apply device-appropriate configuration</errorContext>
    </scenario>
    <scenario name="Scenario 4: Debugging and Device Feature Discovery">
      <description>A developer is implementing logging configuration support and encounters ErrorLoggingOfEventNotConfigurable. The exception is used to implement device capability discovery - by attempting to configure various event types and catching ErrorLoggingOfEventNotConfigurable, the developer can build a map of which events are configurable on each device type for documentation and feature implementation.</description>
      <relatedFunctions>configureLogging, getEventTypesForLogging</relatedFunctions>
      <errorContext>Exception used for runtime device capability discovery and feature determination</errorContext>
    </scenario>
  </usage>
  <implementationContext>
    <note>The configureLogging function must validate that target event types are configurable before attempting to apply configuration changes</note>
    <note>Each Secure Element model may have a different set of configurable event types - this should be documented in device specifications</note>
    <note>Some event types may be mandatory-log for security or compliance reasons and therefore should never be configurable</note>
    <note>The device's event logging policy defines which events are configurable - this policy is typically set at manufacturing or initialization time</note>
    <note>Applications targeting multiple device types should implement device-specific configuration strategies based on each device's configurable event types</note>
    <note>Error handling should gracefully skip non-configurable events when configuring multiple events in batch operations</note>
    <note>Device capability discovery through attempted configuration (and handling ErrorLoggingOfEventNotConfigurable) can be used to build device feature maps</note>
    <note>Documentation should clearly specify for each event type whether it is configurable and what configuration options are available</note>
  </implementationContext>
</exception>
