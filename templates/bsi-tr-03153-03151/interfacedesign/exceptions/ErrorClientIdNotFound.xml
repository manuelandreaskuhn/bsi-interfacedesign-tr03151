<?xml version='1.0' encoding='UTF-8' standalone='yes'?>
<exception xmlns="http://bsi.bund.de/TR03151" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="ErrorClientIdNotFound" xsi:schemaLocation="http://bsi.bund.de/TR03151 ../../schema/exceptions.xsd">
  <name>ErrorClientIdNotFound</name>
  <description>
    <text xml:lang="en">This exception is thrown if no data has been found for the provided clientID in the context of the export of stored data. The exportFilteredTransactionLogs function attempts to export transaction log data filtered by a specific clientId, but no matching data exists for that client in the storage.</text>
    <text xml:lang="de">Diese Ausnahme wird ausgelöst, wenn für die bereitgestellte clientID im Zusammenhang mit dem Export gespeicherter Daten keine Daten gefunden wurden. Die Funktion exportFilteredTransactionLogs versucht, Transaktionsprotokolldaten gefiltert nach einer bestimmten clientId zu exportieren, aber es existieren keine passenden Daten für diesen Client im Speicher.</text>
  </description>
  <category>Data Export</category>
  <subcategory>Transaction Filtering</subcategory>
  <severity>Medium</severity>
  <javadoc>
    <summary>
      <text xml:lang="en">This class defines the exception ErrorClientIdNotFound that is thrown if no data has been found for the provided clientID in the context of the export of stored data.</text>
      <text xml:lang="de">Diese Klasse definiert die Ausnahme ErrorClientIdNotFound, die ausgelöst wird, wenn für die bereitgestellte clientID im Zusammenhang mit dem Export gespeicherter Daten keine Daten gefunden wurden.</text>
    </summary>
    <description>
      <text xml:lang="en">The ErrorClientIdNotFound exception occurs during transaction log export operations when a specified clientId has no associated transaction log data in storage. This exception is raised after verifying that the clientId does not have any matching transaction data, indicating that the specified client either has not performed any transactions, or all its transaction data has been deleted or previously exported. The exception is raised specifically when a clientId filter is applied to the exportFilteredTransactionLogs function and no data matches the filter criteria.</text>
      <text xml:lang="de">Die Ausnahme ErrorClientIdNotFound tritt während Transaktionsprotokolleport-Vorgängen auf, wenn eine angegebene clientId keine zugeordneten Transaktionsprotokolldaten im Speicher hat. Diese Ausnahme wird ausgelöst, nachdem überprüft wurde, dass die clientId keine passenden Transaktionsdaten hat, was darauf hinweist, dass der angegebene Client entweder keine Transaktionen durchgeführt hat oder alle seine Transaktionsdaten gelöscht oder zuvor exportiert wurden. Die Ausnahme wird speziell ausgelöst, wenn ein clientId-Filter auf die Funktion exportFilteredTransactionLogs angewendet wird und keine Daten den Filterkriterien entsprechen.</text>
    </description>
  </javadoc>
  <specification>
    <source>BSI TR-03151-1</source>
    <section>3.3.17 Transaction Export - exportFilteredTransactionLogs Function (3.3.17.4)</section>
    <requirement>
      <text xml:lang="en">The exception ErrorClientIdNotFound SHALL be raised by the function exportFilteredTransactionLogs if no data is available for the provided clientId. If the parameter clientId is provided and no transaction data is available for this clientId in storage, the function SHALL raise the exception ErrorClientIdNotFound and exit the function without returning any export data. This ensures that the application is informed when a client filter does not match any stored transactions.</text>
      <text xml:lang="de">Die Ausnahme ErrorClientIdNotFound sollte von der Funktion exportFilteredTransactionLogs ausgelöst werden, wenn für die bereitgestellte clientId keine Daten verfügbar sind. Falls der Parameter clientId bereitgestellt wird und für diese clientId im Speicher keine Transaktionsdaten verfügbar sind, sollte die Funktion die Ausnahme ErrorClientIdNotFound auslösen und die Funktion beenden, ohne Exportdaten zurückzugeben. Dies stellt sicher, dass die Anwendung informiert wird, wenn ein Client-Filter keine gespeicherten Transaktionen entspricht.</text>
    </requirement>
    <applicability>
      <text xml:lang="en">Transaction log export operations using the exportFilteredTransactionLogs function when a client-specific filter is applied without any matching data</text>
      <text xml:lang="de">Transaktionsprotokolleport-Vorgänge mit der Funktion exportFilteredTransactionLogs, wenn ein Client-spezifischer Filter ohne passende Daten angewendet wird</text>
    </applicability>
    <reference>exportFilteredTransactionLogs – Function (3.3.17) - Section 3.3.17.4 Exception Specification</reference>
  </specification>
  <thrownBy>
    <function>exportFilteredTransactionLogs</function>
  </thrownBy>
  <triggerConditions>
    <condition>
      <scenario>
        <text xml:lang="en">Client filter with no matching data</text>
        <text xml:lang="de">Client-Filter ohne passende Daten</text>
      </scenario>
      <description>
        <text xml:lang="en">The exportFilteredTransactionLogs function is invoked with a clientId parameter that has no associated transaction log data in storage</text>
        <text xml:lang="de">Die Funktion exportFilteredTransactionLogs wird mit einem clientId-Parameter aufgerufen, der keine zugeordneten Transaktionsprotokolldaten im Speicher hat</text>
      </description>
      <trigger>
        <text xml:lang="en">The function queries the device storage for transaction logs matching the specified clientId. The storage contains no transactions for this clientId. ErrorClientIdNotFound is raised.</text>
        <text xml:lang="de">Die Funktion fragt den Gerätespeicher nach Transaktionsprotokollen ab, die der angegebenen clientId entsprechen. Der Speicher enthält keine Transaktionen für diese clientId. ErrorClientIdNotFound wird ausgelöst.</text>
      </trigger>
    </condition>
    <condition>
      <scenario>
        <text xml:lang="en">Client filter combined with transaction number filter</text>
        <text xml:lang="de">Client-Filter kombiniert mit Transaktionsnummernfilter</text>
      </scenario>
      <description>
        <text xml:lang="en">The exportFilteredTransactionLogs function is invoked with a clientId parameter in combination with a transactionNumber parameter, but no data matches both criteria</text>
        <text xml:lang="de">Die Funktion exportFilteredTransactionLogs wird mit einem clientId-Parameter in Kombination mit einem transactionNumber-Parameter aufgerufen, aber keine Daten entsprechen beiden Kriterien</text>
      </description>
      <trigger>
        <text xml:lang="en">The function searches for transactions matching both the clientId and transactionNumber filters. No transaction exists that matches both criteria. ErrorClientIdNotFound is raised.</text>
        <text xml:lang="de">Die Funktion sucht nach Transaktionen, die sowohl den clientId- als auch den transactionNumber-Filtern entsprechen. Es existiert keine Transaktion, die beiden Kriterien entspricht. ErrorClientIdNotFound wird ausgelöst.</text>
      </trigger>
    </condition>
    <condition>
      <scenario>
        <text xml:lang="en">Client filter combined with date range filter</text>
        <text xml:lang="de">Client-Filter kombiniert mit Datumbereichsfilter</text>
      </scenario>
      <description>
        <text xml:lang="en">The exportFilteredTransactionLogs function is invoked with a clientId parameter in combination with a date range, but the clientId has no data in that date range</text>
        <text xml:lang="de">Die Funktion exportFilteredTransactionLogs wird mit einem clientId-Parameter in Kombination mit einem Datumsbereich aufgerufen, aber die clientId hat keine Daten in diesem Datumsbereich</text>
      </description>
      <trigger>
        <text xml:lang="en">The function searches for transactions from the specified clientId within the specified date range. The clientId has transactions but none within the date range. ErrorClientIdNotFound is raised.</text>
        <text xml:lang="de">Die Funktion sucht nach Transaktionen von der angegebenen clientId innerhalb des angegebenen Datumsbereichs. Die clientId hat Transaktionen, aber keine im Datumsbereich. ErrorClientIdNotFound wird ausgelöst.</text>
      </trigger>
    </condition>
    <condition>
      <scenario>
        <text xml:lang="en">Client has never performed transactions</text>
        <text xml:lang="de">Client hat nie Transaktionen durchgeführt</text>
      </scenario>
      <description>
        <text xml:lang="en">The clientId corresponds to a registered or previously registered client that has never initiated any transactions</text>
        <text xml:lang="de">Die clientId entspricht einem registrierten oder zuvor registrierten Client, der nie Transaktionen eingeleitet hat</text>
      </description>
      <trigger>
        <text xml:lang="en">The client was registered but never performed any transaction operations. When exportFilteredTransactionLogs is called with this clientId, no data is found. ErrorClientIdNotFound is raised.</text>
        <text xml:lang="de">Der Client wurde registriert, hat aber nie Transaktionsvorgänge durchgeführt. Wenn exportFilteredTransactionLogs mit dieser clientId aufgerufen wird, werden keine Daten gefunden. ErrorClientIdNotFound wird ausgelöst.</text>
      </trigger>
    </condition>
  </triggerConditions>
  <executionSequence>
    <step number="1">
      <text xml:lang="en">User/application calls exportFilteredTransactionLogs function with filter parameters including clientId</text>
      <text xml:lang="de">Benutzer/Anwendung ruft die Funktion exportFilteredTransactionLogs mit Filterparametern einschließlich clientId auf</text>
    </step>
    <step number="2">
      <text xml:lang="en">Function checks authentication status (if required by referencing guideline)</text>
      <text xml:lang="de">Funktion prüft den Authentifizierungsstatus (falls von der Richtlinie erforderlich)</text>
    </step>
    <step number="3">
      <text xml:lang="en">Function checks authorization (if required by referencing guideline)</text>
      <text xml:lang="de">Funktion prüft die Autorisierung (falls von der Richtlinie erforderlich)</text>
    </step>
    <step number="4">
      <text xml:lang="en">Function checks device initialization status</text>
      <text xml:lang="de">Funktion prüft den Geräteinitalisierungsstatus</text>
    </step>
    <step number="5">
      <text xml:lang="en">Function validates filter parameters for format and validity</text>
      <text xml:lang="de">Funktion validiert Filterparameter auf Format und Gültigkeit</text>
    </step>
    <step number="6">
      <text xml:lang="en">Function queries device storage for transactions matching filter criteria</text>
      <text xml:lang="de">Funktion fragt Gerätespeicher nach Transaktionen ab, die Filterkriterien entsprechen</text>
    </step>
    <step number="6a">
      <text xml:lang="en">If clientId filter is specified and no transactions match → ErrorClientIdNotFound raised and function exits</text>
      <text xml:lang="de">Falls clientId-Filter angegeben ist und keine Transaktionen entsprechen → ErrorClientIdNotFound wird ausgelöst und Funktion wird beendet</text>
    </step>
    <step number="7">
      <text xml:lang="en">If transactions match the filter criteria, function retrieves matching transaction log data</text>
      <text xml:lang="de">Falls Transaktionen den Filterkriterien entsprechen, ruft die Funktion passende Transaktionsprotokolldaten ab</text>
    </step>
    <step number="8">
      <text xml:lang="en">Function packages transaction data into export structure</text>
      <text xml:lang="de">Funktion packt Transaktionsdaten in Exportstruktur</text>
    </step>
    <step number="9">
      <text xml:lang="en">Function returns export data containing filtered transactions to the user</text>
      <text xml:lang="de">Funktion gibt Exportdaten mit gefilterten Transaktionen an Benutzer zurück</text>
    </step>
  </executionSequence>
  <recovery>
    <step>
      <text xml:lang="en">Verify the clientId actually exists using getRegisteredClients</text>
      <text xml:lang="de">Überprüfen Sie mit getRegisteredClients, dass die clientId tatsächlich existiert</text>
    </step>
    <step>
      <text xml:lang="en">Confirm clientId spelling and format matches registered client</text>
      <text xml:lang="de">Bestätigen Sie, dass die Schreibweise und das Format der clientId dem registrierten Client entspricht</text>
    </step>
    <step>
      <text xml:lang="en">Check if client was already deregistered and no longer available</text>
      <text xml:lang="de">Überprüfen Sie, ob der Client bereits abgemeldet wurde und nicht mehr verfügbar ist</text>
    </step>
    <step>
      <text xml:lang="en">Use valid registered clientId for export operations</text>
      <text xml:lang="de">Verwenden Sie eine gültige registrierte clientId für Exportvorgänge</text>
    </step>
    <step>
      <text xml:lang="en">Review data selection criteria before export</text>
      <text xml:lang="de">Überprüfen Sie die Datenauswahlkriterien vor dem Export</text>
    </step>
  </recovery>
  <relatedExceptions>
    <exception>ErrorNoDataAvailable</exception>
    <exception>ErrorParameterMismatch</exception>
    <exception>ErrorFunctionFailed</exception>
    <exception>ErrorDeviceNotInitialized</exception>
  </relatedExceptions>
  <postconditionality>
    <state>
      <text xml:lang="en">Export operation not completed - no data returned to caller</text>
      <text xml:lang="de">Exportoperation nicht abgeschlossen - keine Daten an Aufrufer zurückgegeben</text>
    </state>
    <state>
      <text xml:lang="en">Transaction storage unchanged - no data was retrieved or removed</text>
      <text xml:lang="de">Transaktionsspeicher unverändert - keine Daten wurden abgerufen oder entfernt</text>
    </state>
    <state>
      <text xml:lang="en">Device state unchanged - no modifications made during failed export attempt</text>
      <text xml:lang="de">Gerätezustand unverändert - keine Änderungen während fehlgeschlagenen Exportversuchs vorgenommen</text>
    </state>
    <state>
      <text xml:lang="en">Filter criteria not matched - the specified clientId has no transaction data</text>
      <text xml:lang="de">Filterkriterien nicht erfüllt - die angegebene clientId hat keine Transaktionsdaten</text>
    </state>
    <state>
      <text xml:lang="en">Function exits without creating export data - export operation failed to retrieve data</text>
      <text xml:lang="de">Funktion wird beendet, ohne Exportdaten zu erstellen - Exportoperation konnte keine Daten abrufen</text>
    </state>
    <state>
      <text xml:lang="en">No state inconsistency - function exits at filter matching phase</text>
      <text xml:lang="de">Keine Statusinkonsistenz - Funktion wird in Filtervergleichsphase beendet</text>
    </state>
  </postconditionality>
  <notes>
    <note>
      <text xml:lang="en">Indication: Cannot find data for the specified client ID during export or filtering operations</text>
      <text xml:lang="de">Anzeichen: Kann keine Daten für die angegebene Client-ID während Export- oder Filtervorgängen finden</text>
    </note>
    <note>
      <text xml:lang="en">Topics: Data Export, Client Identification, Transaction Filtering, Data Retrieval</text>
      <text xml:lang="de">Themen: Dateneport, Client-Identifikation, Transaktionsfilterung, Datenabruf</text>
    </note>
  </notes>
  <usage>
    <scenario name="Scenario 1: Client-Filtered Export with No Data">
      <description>
        <text xml:lang="en">Attempt to export transaction logs filtered by a specific clientId and handle the case where no data exists for that client. The export fails because the specified client either never performed transactions or all its transactions have been deleted.</text>
        <text xml:lang="de">Versuchen Sie, Transaktionsprotokolle zu exportieren, gefiltert nach einer bestimmten clientId, und behandeln Sie den Fall, in dem für diesen Client keine Daten vorhanden sind. Der Export schlägt fehl, weil der angegebene Client entweder nie Transaktionen durchgeführt hat oder alle seine Transaktionen gelöscht wurden.</text>
      </description>
      <relatedFunctions>
        <text xml:lang="en">exportFilteredTransactionLogs, getRegisteredClients</text>
        <text xml:lang="de">exportFilteredTransactionLogs, getRegisteredClients</text>
      </relatedFunctions>
      <errorContext>
        <text xml:lang="en">No transaction data for specified clientId - filter criteria not matched - client has no transaction history</text>
        <text xml:lang="de">Keine Transaktionsdaten für angegebene clientId - Filterkriterien nicht erfüllt - Client hat keine Transaktionshistorie</text>
      </errorContext>
    </scenario>
    <scenario name="Scenario 2: Fallback to Broader Export">
      <description>
        <text xml:lang="en">When a client-specific export fails with ErrorClientIdNotFound, the application falls back to exporting all transaction data without client filtering to verify that the storage system itself is working correctly.</text>
        <text xml:lang="de">Wenn ein Client-spezifischer Export mit ErrorClientIdNotFound fehlschlägt, wird die Anwendung auf den Export aller Transaktionsdaten ohne Client-Filterung zurückgreifen, um zu überprüfen, dass das Speichersystem selbst ordnungsgemäß funktioniert.</text>
      </description>
      <relatedFunctions>
        <text xml:lang="en">exportFilteredTransactionLogs</text>
        <text xml:lang="de">exportFilteredTransactionLogs</text>
      </relatedFunctions>
      <errorContext>
        <text xml:lang="en">Client filter failed - fallback to unfiltered export - verify storage operational</text>
        <text xml:lang="de">Client-Filter fehlgeschlagen - Fallback auf ungefilterten Export - Speicher funktionsfähig überprüfen</text>
      </errorContext>
    </scenario>
    <scenario name="Scenario 3: Client Data Availability Verification">
      <description>
        <text xml:lang="en">Before attempting export, check the list of registered clients and verify that the target client actually has transaction data before attempting a filtered export operation.</text>
        <text xml:lang="de">Überprüfen Sie vor dem Exportversuch die Liste der registrierten Clients und stellen Sie sicher, dass der Ziel-Client tatsächlich Transaktionsdaten hat, bevor Sie einen gefilterten Exportvorgang versuchen.</text>
      </description>
      <relatedFunctions>
        <text xml:lang="en">exportFilteredTransactionLogs, getRegisteredClients, getTransactionState</text>
        <text xml:lang="de">exportFilteredTransactionLogs, getRegisteredClients, getTransactionState</text>
      </relatedFunctions>
      <errorContext>
        <text xml:lang="en">Proactive client data verification - check client status before filtered export</text>
        <text xml:lang="de">Proaktive Client-Datenüberprüfung - überprüfen Sie den Client-Status vor gefiltertem Export</text>
      </errorContext>
    </scenario>
    <scenario name="Scenario 4: Multi-Client Batch Export with Error Handling">
      <description>
        <text xml:lang="en">Export transaction data for each registered client in a batch operation, gracefully handling clients that have no transaction data available by catching ErrorClientIdNotFound and continuing with the next client.</text>
        <text xml:lang="de">Exportieren Sie Transaktionsdaten für jeden registrierten Client in einem Batch-Betrieb, behandeln Sie elegant Clients, die keine Transaktionsdaten verfügbar haben, indem Sie ErrorClientIdNotFound abfangen und zum nächsten Client fortfahren.</text>
      </description>
      <relatedFunctions>
        <text xml:lang="en">exportFilteredTransactionLogs, getRegisteredClients</text>
        <text xml:lang="de">exportFilteredTransactionLogs, getRegisteredClients</text>
      </relatedFunctions>
      <errorContext>
        <text xml:lang="en">Batch client export - selective client data collection - client data availability detection</text>
        <text xml:lang="de">Batch-Client-Export - selektive Client-Datensammlung - Client-Datenverfügbarkeitserkennung</text>
      </errorContext>
    </scenario>
  </usage>
  <implementationContext>
    <note>
      <text xml:lang="en">Raised by exportFilteredTransactionLogs when specified clientId has no matching data</text>
      <text xml:lang="de">Wird von exportFilteredTransactionLogs ausgelöst, wenn die angegebene clientId keine passenden Daten hat</text>
    </note>
    <note>
      <text xml:lang="en">Export functions filter transaction logs by clientId parameter</text>
      <text xml:lang="de">Exportfunktionen filtern Transaktionsprotokolle nach clientId-Parameter</text>
    </note>
    <note>
      <text xml:lang="en">Search operation returns empty result when clientId does not exist</text>
      <text xml:lang="de">Suchoperation gibt leeres Ergebnis zurück, wenn clientId nicht existiert</text>
    </note>
    <note>
      <text xml:lang="en">Application must use valid registered clientIds for export operations</text>
      <text xml:lang="de">Anwendung muss gültige registrierte clientIds für Exportvorgänge verwenden</text>
    </note>
  </implementationContext>
</exception>

