flowchart TD
    Start([User: getCurrentLoggingSignatureCounters<br/>call])
    Start --> CheckInit{TSE<br/>initialized?}
    
    CheckInit -->|No| ErrorInit[Exception:<br/>ErrorDeviceNotInitialized]
    CheckInit -->|Yes| GetCounters[SM: Get for each used<br/>Private Key the current<br/>Signature Counter value]
    
    GetCounters --> CheckGet{Retrieval<br/>successful?}
    
    CheckGet -->|No| ErrorGet[Exception:<br/>ErrorGetCurrentSignatureCounterFailed]
    CheckGet -->|Yes| BuildSet[Create SignatureCounterSet:<br/>For each Key:<br/>- keySerialNumber<br/>- counterValue]
    
    BuildSet --> EncodeASN1[Encode as ASN.1 DER]
    
    EncodeASN1 --> Return[Return:<br/>signatureCounters<br/>octet array]
    
    Return --> End([End])
    
    ErrorInit --> End
    ErrorGet --> End
    
    style GetCounters fill:#87CEEB
    style BuildSet fill:#DDA0DD
    style Return fill:#90EE90
    
    Note1[Usage:<br/>- Monitoring<br/>- Plausibility check<br/>- Overflow detection]
    Return -.-> Note1
    
    Note2[The signature counter is<br/>incremented with every<br/>signature]
    GetCounters -.-> Note2
