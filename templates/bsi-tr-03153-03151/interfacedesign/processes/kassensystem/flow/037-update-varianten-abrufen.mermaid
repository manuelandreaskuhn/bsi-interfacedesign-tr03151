flowchart TD
    Start([Nutzer: getSupportedTransactionUpdateVariants])
    Start --> CheckInit{TSE initialisiert?}
    CheckInit -->|Nein| ErrorInit[Exception: ErrorDeviceNotInitialized]
    CheckInit -->|Ja| Identify[Identifiziere unterst端tzte Update-Varianten]
    
    Identify --> Which{Welche Variante?}
    Which -->|Variante A| ReturnA[R端ckgabe: alwaysSigned]
    Which -->|Variante B| ReturnB[R端ckgabe: aggregating]
    Which -->|Beide| ReturnBoth[R端ckgabe: alwaysSignedAndAggregating]
    
    ReturnA --> End([Ende])
    ReturnB --> End
    ReturnBoth --> End
    ErrorInit --> End
    
    style Identify fill:#87CEEB
    style ReturnA fill:#90EE90
    style ReturnB fill:#FFD700
    style ReturnBoth fill:#87CEEB
    
    Note1[alwaysSigned:<br/>Signatur bei jedem Update]
    ReturnA -.-> Note1
    
    Note2[aggregating:<br/>Daten sammeln,<br/>Signatur nur bei finish]
    ReturnB -.-> Note2
