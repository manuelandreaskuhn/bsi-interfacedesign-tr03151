flowchart TD
    Start([Admin/Central Operator:<br/>unlockTransactionLogging aufrufen])
    Start --> CheckAuth{Admin<br/>authentifiziert?}
    
    CheckAuth -->|Nein| ErrorAuth[Exception:<br/>ErrorUserNotAuthenticated/<br/>ErrorUserNotAuthorized]
    CheckAuth -->|Ja| CheckInit{TSE<br/>initialisiert?}
    
    CheckInit -->|Nein| ErrorInit[Exception:<br/>ErrorDeviceNotInitialized]
    CheckInit -->|Ja| CheckLocked{Transaktionen<br/>gesperrt?}
    
    CheckLocked -->|Nein| ErrorNotLocked[Exception:<br/>ErrorTransactionLoggingNotLocked]
    CheckLocked -->|Ja| CreateLog[Erstelle System-Log-Nachricht<br/>unlockTransactionLogging]
    
    CreateLog --> SetOrigin{Aufrufer?}
    SetOrigin -->|Admin| SetOriginAdmin[eventOrigin = Interface<br/>eventTriggeredByUser = admin]
    SetOrigin -->|Central Operator| SetOriginCO[eventOrigin = centraloperator<br/>eventTriggeredByUser = centraloperator]
    
    SetOriginAdmin --> IncrSig
    SetOriginCO --> IncrSig[SM: Signaturzähler++]
    
    IncrSig --> CalcSig[SM: Erstelle Signatur]
    CalcSig --> SaveLog[Speichere Log-Nachricht]
    
    SaveLog --> UnlockFunctions[Entsperre Funktionen:<br/>- startTransaction<br/>- updateTransaction<br/>- finishTransaction]
    
    UnlockFunctions --> CheckUnlock{Entsperrung<br/>erfolgreich?}
    
    CheckUnlock -->|Nein| ErrorUnlock[Exception:<br/>ErrorUnlockTransactionLoggingFailed]
    CheckUnlock -->|Ja| Return[Rückgabe: Erfolg]
    
    Return --> End([Ende - Transaktionen entsperrt])
    
    ErrorAuth --> End
    ErrorInit --> End
    ErrorNotLocked --> End
    ErrorUnlock --> End
    
    style UnlockFunctions fill:#90EE90
    style Return fill:#90EE90
